$Id: RELEASE.TXT 11832 2006-01-19 11:50:23Z jz $


VERSION 1.6.130.4052  2006-01-19
------------------------------------------------

RTF-Prozessor setzt hoch- und tiefgestellte Zeichen (\super und \sub) am Ende einer {}-Gruppe mit \nosupersub zurück.




VERSION 1.6.129  2005-12-27
------------------------------------------------

RTF-Prozesser nimmt \userprops als Dokumenteigenschaft.
Nachfolgende Dokumenteigenschaften gehen damit nicht unter, besonders \paperw für die Papiergröße.




VERSION 1.6.97  2004-09-16
------------------------------------------------

§1701

Urheber: ur 3.9.04, 14.9.04
Wenn eine Hostware-Variable einer anderen Hostware-Variablen zugewiesen wurde, wurde nicht immer der Wert, sondern die Variable selbst zugewiesen.

Jetzt wird der Inhalt (der Wert) der Variablen zugewiesen.

Damit hat auch get_Xml() kein Problem mehr.

------------------------------------------------

§1727

Urheber: jz 16.9.04

Wenn eine Hostware-Variable sich nicht nach XML konviertieren lässt, weil sie ein unbekanntes IDispatch-Objekt ist, 
wird jetzt dieser Fehler mit dem Variablennamen ausgegeben.

------------------------------------------------
VERSION 1.6.98  2004-09-20

§1735  

Urheber: ur, ap 17.9.04

Neue Eigenschaft hostware.Factory_processor.db_name

Neue Java-Methoden sos.hostware.Factory_processor.set_db_name( String ) und .db_name().

Die Java-Factory kann kein Objekt mit add_obj() hinzufügen, weil die Methode nicht implementiert ist. 
Dann müsste VBScript ein Java-Objekt aufrufen können, was etwas aufwendig zu implementieren ist.

#include ruft aber die Callbacks template_filename() und text_filename() von factory_document auf, 
um die Hostware-Dateinamen (Blobs) der Textbausteine zu erhalten.

Das soll der Prozessor jetzt selbst machen. Deshalb die Eigenschaft db_name.

Dieser Datenbankzugriff ist jetzt an drei Stellen programmiert: documentfactory.dll, Andreas' Java-Factory 
und der Dokumentprozessor (und die alte sosfact.dll).

------------------------------------------------
VERSION 1.6.99  2004-09-20

§1230

Urheber: ur 17.9.04

Zeichen ab 0x80 setzt Word in Courier, wenn ein Textbaustein einen Absatz enthält, dessen Schrift von der Schrift der Absatzvorlage abweicht.

Der Textbaustein enthält \loch, \hich und \dbch.

RTF kennt "Associated Character Properties", die vom Aufbereiter besonders behandelt werden müssten. Sie werden deshalb (9.1.03) vom Aufbereiter unterdrückt. Aber nicht \loch (das war damals unklar).

Lösung:
\loch wird vom Aufbereiter unterdrückt.

-----------------------------------------------
VERSION 1.6.102  2004-09-23

§1818 Factory_processor.process() löscht am Ende die Parameter

jz/ap 23.9.04

Factory_processor.process() löscht am Ende die Parameter.
Damit hat kann sich kein Parameter ins nächste Dokument mogeln.


-----------------------------------------------
VERSION 1.6.103  2004-09-30

§1834 Parameterübergabe an ScriptingEngine geändert

Die Parameter werden jetzt nicht mehr einzeln mit add_obj(),
sondern gesammelt als ein Objekt (IVariables2) mit dem Attribut sif_globalmembers übergeben.


§1826 (Noch in Entwicklung) JavaScript SpiderMonkey ScriptingEngine

GILT NUR FÜR DIESE VERSION:
    ACHTUNG Die C++-Software muss mit 

    - msvcr71.dll (Version 7.10.3052.4) und 
    - msvcp71.dll (Version 7.10.3077.0)

    ausgeliefert werden. Das verlangt die neu hinzugefügte Skriptsprache Spidermonkey (JavaScript).


-----------------------------------------------
VERSION 1.6.111.23  2004-11-31

Die DLLs msvcr71.dll und msvcp71.dll werden nicht mehr gebraucht.

Factory_processor.merge_templates = true: Fasst Dokumente verschiedener Vorlagen zusammen.

embed() in Linux funktioniert (anscheinend zum ersten Mal)


-----------------------------------------------
VERSION 1.6.113  2004-11-03

Korrektur im Dokumentprozessor (eMail von ap).


-----------------------------------------------
VERSION 1.6.114  2004-11-11

RTF: Wiederherstellung der Eigenschaften nach #include geändert. 
(Das ursprüngliche Verfahren vom Beginn hat nicht bei allen Textbausteinen funktioniert, jedenfalls nicht bei einem von der AOK).


-----------------------------------------------
VERSION 1.6.115  2004-11-16

Neue Eigenschaft des Dokumentprozessors: factory_constructor.suppress_subdocument = true;

Im Vorlagenskript gesetzt unterdrückt das die Ausgabe des Subdokuments.

-----------------------------------------------
VERSION 1.6.118

Hostware_file.db_open() korrigiert.

RTF-Prozessor um ca. 300 neue RTF-Codes von Word 2003 erweitert.


-----------------------------------------------
VERSION 1.6.124  2005-01-27

Hostole-Variables (für documentfactory.dll): Verschachtelte Variablen werden jetzt korrekt aus XML gelesen.


-----------------------------------------------
VERSION 1.6.127.3710  2005-06-12
  
Für MySQL wird ausgeführt: SET SESSION SQL_MODE='ANSI_QUOTES'. Ein Fehler wird ignoriert.
