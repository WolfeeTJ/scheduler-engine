<html>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="ProgId" content="FrontPage.Editor.Document">
<style type="text/css">
h1           { font-size: 24pt; font-weight: bold; margin-bottom: 4ex;  }
h2           { font-size: 12pt; font-weight: bold; margin-top: 10ex; }
h3           { font-size: 10pt; font-weight: bold; margin-top: 6ex }
.zwischentitel { font-weight: bold; margin-top: 6ex }
td           { font-size: 10pt; margin-top: 2ex; margin-bottom: 0  }
p            { font-size: 10pt; margin-top: 2ex; margin-bottom: 0  }
li           { font-size: 10pt }
pre          { font-family: Lucida Console, monospace; font-size: 9pt; margin-left: 5mm; line-height: 1.2em; }
.indent      { margin-left: 5mm; }
.mono        { font-family: Lucida Console, monospace; font-size: 9pt }
</style>

<title>Aufträge im Spooler - Klasse Spooler</title>
</head>
<body>



<h1>Aufträge im Spooler - Klasse Spooler
</h1>

<p align="right">14. Oktober 2002
</p>

<h2 align="left">Eigenschaften und Methoden</h2>
<p><font class="mono"><a href="#is_service">is_service</a><br>
<a href="#job_chain">job_chain</a><br>
<a href="#create_job_chain">create_job_chain()</a><br>
<a href="#add_job_chain">
add_job_chain()</a></font></p>
<h2><a name="is_service"></a>is_service
</h2>
<p>Liefert True, wenn der Spooler als Windows-Dienst läuft.
</p>
<p>Im Windows-Dienst gehen (derzeit) Ausgaben nach <font class="mono">stderr</font>
verloren.
</p>
<p>Ab Spooler 1.2.24.
</p>
<h2><a name="job_chain"></a>job_chain
</h2>
<p>set <i>job_chain</i> = <font class="mono">spooler.job_chain( &quot;<i>name</i>&quot;
)</font>
</p>
<p>Liefert die <a href="job_chain.html">Jobkette</a> <i>name</i>.
</p>
<h2><a name="create_job_chain"></a>create_job_chain()
</h2>
<p>set <i>job_chain</i> = <font class="mono">spooler.create_job_chain()</font>
</p>
<p>Erzeugt eine neue <a href="job_chain.html">Jobkette</a>. Die Methode kann im Spooler-Skript gerufen
werden, das der Spooler bei seinem Start ausführt.
</p>
<h2><a name="add_job_chain"></a>add_job_chain()
</h2>
<p><font class="mono">spooler.create_job_chain( </font><i>job_chain</i><font class="mono">
)</font>
</p>
<p>Die Methode trägt die <a href="job_chain.html"> Jobkette</a> im Spooler ein und prüft sie dabei, ob alle
Zustände definiert sind. Bei einem Fehler wird eine Exception ausgelöst, die
vom Skript abgefangen werden kann.</p>
<h3>Beispiel
</h3>
<pre>&lt;spooler&gt;
    &lt;script&gt;
<font color="#0000FF">        set job_chain = spooler.create_job_chain()

        job_chain.name = &quot;dokument_drucken&quot;</font>
<font color="#0000FF">        job_chain.add_job &quot;aufbereiten&quot;, 100,  400, 8888
        job_chain.add_job &quot;drucken&quot;    , 400, 1000, 8888
        job_chain.add_end_state 1000
</font>
        on error goto 0
<font color="#0000FF">          spooler.add_job_chain job_chain</font><span style="background-color: #FFFF00">
</span>          if err then spooler_log.warn &quot;Fehler in der Jobkette wird ignoriert: &quot; &amp; err.description
        on error resume next
    &lt;/script&gt;
&lt;/job&gt;</pre>
<h2>create_order()
</h2>
<p><font class="mono">spooler.create_order()</font>
</p>
<p>Liefert einen neuen, leeren <a href="order.html">Auftrag</a>. Er ist in keiner
<a href="job_chain.html"> Jobkette</a> oder <a href="order_queue.html">
Auftragsliste</a> eingetragen.
</p>
<p>&nbsp;
</p>

<HR SIZE=1>
<FONT face="Arial" size="2">Dipl.-Inform. Joacim Zschimmer&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
<A href="mailto:j@zsch.de">j@zsch.de</A>
&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;(030) 3470 2520&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Zschimmer GmbH</FONT>

</body>

</html>
