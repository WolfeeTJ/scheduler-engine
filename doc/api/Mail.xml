<?xml version="1.0"?>
<!-- $Id$ -->

<?xml-stylesheet href="api-default_language.xsl" type="text/xsl"?>


<api.class
    name        = "Mail"
    object_name = "mail"
    base_dir    = "../"
    author      = "$Author$"
    date        = "$Date$"
>


    <property name="smtp">
        <com>
            <com.result>
                <com.type type="BSTR"/>
            </com.result>
        </com>

        <title>
            Name des SMTP-Servers
        </title>

        <example programming_language="java">
            <pre>spooler_log.mail().set_smtp( "mail.company.com" );</pre>
        </example>

        <example programming_language="javascript">
            <pre>spooler_log.mail.smtp = "mail.company.com";</pre>
        </example>
    </property>


    <property name="queue_dir">
        <com>
            <com.result name="path">
                <com.type type="BSTR"/>
            </com.result>
        </com>

        <title>
            Verzeichnis der nicht versendbaren eMails
        </title>
    </property>


    <property name="from">
        <com>
            <com.result>
                <com.type type="BSTR"/>
            </com.result>
        </com>

        <title>
            Absender
        </title>

        <example programming_language="java">
            <pre>spooler_log.mail().set_from( "scheduler@company.com" );</pre>
        </example>

        <example programming_language="javascript">
            <pre>spooler_log.mail.from = "scheduler@company.com";</pre>
        </example>
    </property>


    <property name="to">
        <com>
            <com.result>
                <com.type type="BSTR"/>
            </com.result>
        </com>

        <title>
            Empfänger
        </title>

        <description>
            <p>
                Wenn die Hostware zum eMail-Versand JavaMail verwendet,
                können Sie mehere Adressen durch Komma getrennt angeben.
                Siehe <a href="http://java.sun.com/products/javamail/javadocs/javax/mail/internet/InternetAddress.html#parse(java.lang.String)">javax.mail.InternetAddress.parse(String)</a>.
            </p>
        </description>

        <example programming_language="java">
            <pre>spooler_log.mail().set_to( "admin@company.com" );</pre>
        </example>

        <example programming_language="javascript">
            <pre>spooler_log.mail.to = "admin@company.com";</pre>
        </example>
    </property>


    <property name="cc">
        <com>
            <com.result>
                <com.type type="BSTR"/>
            </com.result>
        </com>

        <title>
            Empfänger einer Kopie der Nachricht, <i>carbon copy</i>
        </title>

        <description>
            <p>
                Wenn die Hostware zum eMail-Versand JavaMail verwendet,
                können Sie mehere Adressen durch Komma getrennt angeben.
                Siehe <a href="http://java.sun.com/products/javamail/javadocs/javax/mail/internet/InternetAddress.html#parse(java.lang.String)">javax.mail.InternetAddress.parse(String)</a>.
            </p>
        </description>

        <example programming_language="java">
            <pre>spooler_log.mail().set_cc( "hans@company.com" );</pre>
        </example>

        <example programming_language="javascript">
            <pre>spooler_log.mail.cc = "hans@company.com";</pre>
        </example>
    </property>


    <property name="bcc">
        <com>
            <com.result>
                <com.type type="BSTR"/>
            </com.result>
        </com>

        <title>
            Unsichtbarer Empfänger einer Kopie der Nachricht, <i>blind carbon copy</i>
        </title>

        <description>
            <p>
                Wenn die Hostware zum eMail-Versand JavaMail verwendet,
                können Sie mehere Adressen durch Komma getrennt angeben.
                Siehe <a href="http://java.sun.com/products/javamail/javadocs/javax/mail/internet/InternetAddress.html#parse(java.lang.String)">javax.mail.InternetAddress.parse(String)</a>.
            </p>
        </description>

        <example programming_language="java">
            <pre>spooler_log.mail().set_bcc( "hans@company.com" );</pre>
        </example>

        <example programming_language="javascript">
            <pre>spooler_log.mail.bcc = "hans@company.com";</pre>
        </example>
    </property>


    <property name="subject">
        <com>
            <com.result>
                <com.type type="BSTR"/>
            </com.result>
        </com>

        <title>
            Betreff
        </title>

        <example programming_language="java">
            <pre>spooler_log.mail().set_subject( "Job succeeded" );</pre>
        </example>

        <example programming_language="javascript">
            <pre>spooler_log.mail.subject = "Job succeeded";</pre>
        </example>
    </property>


    <property name="body">
        <com>
            <com.result>
                <com.type type="BSTR"/>
            </com.result>
        </com>

        <title>
            Inhalt der Nachricht
        </title>

        <description>
            Codieren SIe Zeilenwechsel mit <code>\n</code> (in VBScript mit <code>chr(10)</code>).
        </description>

        <example programming_language="java">
            <pre>spooler_log.mail().set_body( "Job succeeded" );</pre>
        </example>

        <example programming_language="javascript">
            <pre>spooler_log.mail.body = "Job succeeded";</pre>
        </example>
    </property>


    <method name="add_file">
        <com>
            <com.parameter name="path">
                <com.type type="BSTR"/>

                <description>
                    Pfadname der anzuhängenden Datei
                </description>
            </com.parameter>

            <com.parameter name="filename_for_mail" optional="true">
                <com.type type="BSTR"/>

                <description>
                    Dateiname, der in der Nachricht erscheinen soll
                </description>
            </com.parameter>

            <com.parameter name="content_type" optional="true">
                <com.type type="BSTR"/>

                <description>
                    <code>"text/plain"</code> ist voreingestellt.
                </description>
            </com.parameter>

            <com.parameter name="enconding" optional="true">
                <com.type type="BSTR"/>
                <description>
                    Z.B. <code>"quoted-printable"</code>
                </description>
            </com.parameter>
        </com>

        <title>
            Fügt einen Anhang hinzu
        </title>

        <example programming_language="java">
            <pre>spooler_log.mail().add_file( "c:/tmp/1.txt", "1.txt", "text/plain", "quoted-printable" );</pre>
        </example>

        <example programming_language="javascript">
            <pre>spooler_log.mail.add_file( "c:/tmp/1.txt", "1.txt", "text/plain", "quoted-printable" );</pre>
        </example>
    </method>


    <method name="add_header_field">
        <com>
            <com.parameter name="field_name">
                <com.type type="BSTR"/>
            </com.parameter>

            <com.parameter name="value">
                <com.type type="BSTR"/>
            </com.parameter>
        </com>

        <title>
            Fügt dem eMail-Kopf ein Feld hinzu
        </title>
    </method>


    <method name="dequeue">
        <com>
            <com.result name="count">
                <com.type type="int"/>
                <description>
                    Zahl der versandten Nachrichten
                </description>
            </com.result>
        </com>

        <title>
            Nachrichten aus dem Verzeichnis <code>queue_dir</code> erneut versuchen zu versenden
        </title>

        <description>
            <p>
                Siehe <scheduler_method class="Mail" property="dequeue_log"/>,
                <scheduler_ini_entry file="factory.ini" section="spooler" entry="mail_queue_dir"/>.
            </p>
        </description>
    </method>


    <property name="dequeue_log" access="read">
        <com>
            <com.result name="content">
                <com.type type="BSTR"/>
            </com.result>
        </com>
        
        <title>
            Protokoll von <code>dequeue()</code>
        </title>
        
        <description>
            <p>
                Siehe <scheduler_method class="Mail" method="dequeue"/>.
            </p>
        </description>
        
        <example programming_language="javascript">
            <pre>var count = spooler_log.mail.dequeue();
spooler_log.info( count + " messages from mail queue sent" );
spooler_log.info( spooler_log.mail.dequeue_log );</pre>
        </example>
    </property>


    <property name="xslt_stylesheet_path" access="write">
        <com>
            <com.result name="path">
                <com.type type="BSTR"/>

                <description>
                    Der Pfad der Datei, die das XSLT-Stylesheet enthält
                </description>
            </com.result>
        </com>

        <java>
            <java.parameter name="path">
                <java.type type="java.io.path"/>
            </java.parameter>
        </java>

        <java>
            <java.parameter name="path">
                <com.type type="BSTR"/>
            </java.parameter>
        </java>

        <title>
            XSLT-Stylesheet für eMail-Aufbereitung
        </title>

        <description>
            <p>
                Siehe <scheduler_element name="config" attribute="mail_xslt_stylesheet"/>.
            </p>
        </description>


        <example programming_language="java">
            <pre>spooler_log.mail().set_xslt_stylesheet_path( "c:/stylesheets/mail.xslt" );</pre>
        </example>

        <example programming_language="javascript">
            <pre>spooler_log.mail.xslt_stylesheet_path = "c:/stylesheets/mail.xslt";</pre>
        </example>
    </property>


    <property name="xslt_stylesheet" access="read">
        <com>
            <com.result name="path">
                <com.type class="Xslt_stylesheet"/>

                <description>
                    Das XSLT-Stylesheet als String
                </description>
            </com.result>
        </com>

        <title>
            XSLT-Stylesheet für eMail-Aufbereitung
        </title>
    </property>


    <title>
        eMail-Versand
    </title>


    <description>
        <p>
        </p>
    </description>

</api.class>
