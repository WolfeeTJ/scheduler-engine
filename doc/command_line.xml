<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet href="scheduler.xsl" type="text/xsl"?>

<!--$Id$-->

<command_line program  = "scheduler"
              title    = "Kommandozeile"
              base_dir = ""
              author   = "$Author$"
              date     = "$Date$">

    <command_options>
        <command_option name="config" setting="config">
            <description>
                <p>
                    "<code>-config=</code>" vor dem Dateinamen kann weggelassen werden.
                </p>
            </description>
        </command_option>


        <command_option name="log-dir" setting="log_dir"/>


        <command_option name="V" title="Versionsnummer zeigen">
            <description>
                <p>
                    Lässt den Scheduler beim Start Versionsnummer und Versionsdatum ausgeben.
                </p>
            </description>
        </command_option>


        <command_option name="id" setting="option_id"/>

        <command_option name="cd" setting="directory"/>

        <command_option name="pid-file" type="dateiname" title="Dateiname für Prozess-Id">
            <description>
                <p>
                    Für Unix:
                    In diese Datei schreibt der Scheduler seine Pid.
                    Beim Beenden löscht der Scheduler die Datei.
                </p>
            </description>
        </command_option>


        <command_option name="log-level"    setting="log_level"/>
        <command_option name="param"        setting="param"/>
        <command_option name="include-path" setting="include_path"/>
        <command_option name="port"         setting="port"/>
        <command_option name="tcp-port"     setting="tcp_port"/>
        <command_option name="udp-port"     setting="udp_port"/>

        <command_option name="reuse-port" title="TCP- und UDP-Port wiederverwenden (im Notfall)">
            <description>
                <p>
                    Ruft <code>setsockopt(socket,SOL_SOCKET,SO_REUSEADDR,true)</code>.
                </p>
                <p>
		    Die Option sollte <span style="text-decoration: underline">nur im Notfall</span> benutzt werden,
		    falls das Betriebssystem den Port dauerhaft sperrt,
		    obwohl keine Anwendung ihn mehr belegt.
		    Das kann unter Windows XP passieren, wenn die Anwendung mit einem Debugger abgebrochen wird.
		    Suse 8.0 kann fast eine Minute brauchen, um einen Port freizugeben.
                </p>
                <p>
		    U.U. ist der Scheduler mit <code>-reuse-port</code> über TCP oder UDP nicht erreichbar,
		    weil statt dessen der Port der anderen Anwendung angesprochen wird.
                </p>
                <p>
		    Wenn ein Port blockiert ist, versucht der Scheduler eine Minute lang, ihn zu belegen, bevor er aufgibt.
                </p>
            </description>
        </command_option>


        <command_option name="show-dtd" title="schreibt die DTD nach stdout">
            <description>
                <p>
                    Der Scheduler hat eine DTD,
                    der die XML-Kommandos und die XML-Konfiguration entsprechen müssen.
                </p>

                <p>
                    Beispiel: <code>scheduler -show-dtd | less</code>
                </p>
            </description>
        </command_option>


        <command_option name="cmd" type="xmlkommando" title="Sofort auszuführendes Kommando">
            <description>
                <p>
                    Der Scheduler führt beim Start das XML-Kommando aus.
                    Das kann z.B. ein <scheduler_element name="start_job"/> sein.
                </p>
            </description>
        </command_option>


        <command_option name="send-cmd" type="xmlkommando" title="Anderem Scheduler zu schickendes Kommando">
            <description>
                <p>
                    Mit dieser Option startet der Scheduler nicht,
                    sondern schickt einem anderen Scheduler mit gleicher Option <code>-tcp-port=</code>
                    auf demselben Rechner das XML-Kommando.
                    Das kann z.B. ein <scheduler_element name="terminate"/> sein: <code>-send-cmd="&lt;terminate/>"</code>
                </p>
            </description>
        </command_option>


        <command_option name="ini" type="dateiname" title="Anderer Name für Datei factory.ini">
            <description>
                <p>
                    Wählt eine andere Datei für die Datei <a href="factory_ini.xml"><code>factory.ini</code></a> aus.
                </p>
                <p>
                    In dieser Dokumentation ist dann mit der Datei <code>factory.ini</code> die hier eingestellte gemeint.
                </p>
                <p>
                    Siehe auch <scheduler_method class="Spooler" property="ini_path"/>
                </p>
            </description>
        </command_option>


        <command_option name="sos.ini" type="dateiname" title="Anderer Name für Datei sos.ini">>
            <description>
                <p>
                    Wählt eine andere Datei für die Hostware-Konfiguration <a href="sos_ini.xml"><code>sos.ini</code></a> aus.
                    Diese Datei enthält u.a. den Lizenzschlüssel.
                </p>
            </description>
        </command_option>


        <command_option name="program-file" type="dateiname" title="Dateiname des Schedulers">
            <description>
                <p>
                    Beim Aufruf des Schedulers aus einer Java-Klasse heraus (zum Debuggen)
                    geben Sie hier den Programmdateinamen an,
                    wenn der Scheduler Jobs in eigenen Prozessen starten können soll.
                </p>
            </description>
        </command_option>


        <command_option name="service" title="Als Daemon starten">
            <description>
                <p>
                    Unter Unix versetzt sich der Scheduler in den Hintergrund und trennt sich vom Terminal.
                    stdout und stderr sollten in eine Datei umgeleitet werden, damit Ausgaben nicht verloren gehen.
                </p>
            </description>
        </command_option>


        <command_option name="install-service" type="name" title="Als Windows-Dienst installieren">
            <description>
                <scheduler_keyword keyword="Service"/>
                <scheduler_keyword keyword="Dienst"/>
                <p>
                    Die Option startet nicht den Scheduler,
                    sondern installiert ihn als Windows-Dienst.
                    Dabei werden folgende Optionen aus der Kommandozeile übernommen:
                </p>
                <p>
                    <scheduler_option name="cd"/><br/>
                    <scheduler_option name="config"/><br/>
                    <scheduler_option name="id"/><br/>
                    <scheduler_option name="ini"/><br/>
                    <scheduler_option name="log"/><br/>
                    <scheduler_option name="pid-file"/><br/>
                    <scheduler_option name="sos.ini"/><br/>
                </p>
                <p>
                    <code>-install-service=</code><i>name</i> ist dasselbe wie
                    <code>-install-service -service-name=</code><i>name</i>.
                </p>
            </description>
        </command_option>


        <command_option name="remove-service" type="name" title="Windows-Dienst entfernen">
            <description>
                <scheduler_keyword keyword="Service"/>
                <scheduler_keyword keyword="Dienst"/>
                <p>
                    Entfernt einen zuvor mit <code>-install-service</code> installierten Dienst.
                </p>
                <p>
                    <code>-remove-service=</code><i>name</i> ist dasselbe wie
                    <code>-remove-service -service-name=</code><i>name</i>.
                </p>
            </description>
        </command_option>

<!-- funktioniert nicht 2005-01-22
        <command_option name="renew-service" type="name" title="Windows-Dienst entfernen und erneut installieren">
            <description>
                <scheduler_keyword keyword="Service"/>
                <scheduler_keyword keyword="Dienst"/>
                <p>
                    <code>-renew-service=</code><i>name</i> ist dasselbe wie
                    <code>-renew-service -service-name=</code><i>name</i>.
                </p>
            </description>
        </command_option>
-->

        <command_option name="service-name" type="name" initial="sos_scheduler" title="Interner Name des Windows-Dienstes">
            <description>
                <p>
                    Nur in Verbindung mit <code>-install-service</code> oder <code>-remove-service</code>.
                    Wenn diese Option fehlt und <code>-id=</code> angegeben ist,
                    verwendet der Scheduler den Namen <code>sos_scheduler_</code><i>scheduler_id</i>.
                </p>
            </description>
        </command_option>


        <command_option name="service-display" type="text" title="Angezeigter Name des Windows-Dienstes">
            <description>
                <p>
                    Nur in Verbindung mit <code>-install-service</code>.
                    Die Dienstesteuerung von Windows zeigt diesen Namen.
                    Er darf Leerzeichen enthalten.
                    Wenn die Option fehlt, erzeugt der Scheduler einen aus dem Dienstnamen (s. <code>-service-name=</code>).
                </p>
            </description>
        </command_option>


        <command_option name="service-descr" type="text" title="Beschreibung des Windows-Dienstes">
            <description>
                <p>
                    Nur in Verbindung mit <code>-install-service</code>.
                </p>
            </description>
        </command_option>


        <command_option name="need-service" type="name" title="Vom Scheduler vorausgesetzter Dienst">
            <description>
                <p>
                    In Verbindung mit <code>-install-service</code> können Sie hier einen anderen Dienst angegeben,
                    der laufen soll, bevor Windows den Scheduler-Dienst startet.
                    Das kann z.B. ein Datenbank-Server sein.
                </p>
                <p>
                    Diese Option kann wiederholt angegeben werden, wenn der Scheduler mehrere Dienste voraussetzt.
                </p>
            </description>
        </command_option>

    </command_options>

    <description>
        <p>
            Der Programmdateiname <code>scheduler</code> muss absolut und vollständig angegeben werden.
            In Windows mit der Endung "<code>.exe</code>"
            (warum? weil der Scheduler den vollständigen Dateinamen braucht, um einen Job oder sich selbst neu zu starten).
        </p>
        <p>
            Die Parameter (rechts vom Gleichheitszeichen) können in Anführungszeichen oder in Aprostrophe
            gesetzt werden.
        </p>
    </description>

    <scheduler_keyword keyword="Kommandozeile"/>
    <scheduler_keyword keyword="Optionen"/>

</command_line>
