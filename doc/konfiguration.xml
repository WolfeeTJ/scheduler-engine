<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet href="scheduler.xsl" type="text/xsl"?>


<!--$Id$-->

<description
    title    = "XML-Konfiguration"
    base_dir = ""
    author   = "$Author$"
    date     = "$Date$"
>

<scheduler_keyword keyword="Konfiguration"/>
<scheduler_keyword keyword="XML-Konfiguration"/>

<p>
    Beim Start des Scheduler geben Sie die Datei an,
    die die in XML formulierte Konfiguration enthält.
</p>

<h2>Beispiel</h2>

<p>
    Eine einfache Konfigurationsdatei mit einem Job in JavaScript (für Windows):
</p>
<!--
<p>
    Die <code>DOCTYPE</code>-Zeile ist optional. Hier ist die jeweils aktuelle DTD eingestellt
</p>
-->
<pre>&lt;?xml version="1.0"?>
&lt;spooler>
    &lt;config>
        &lt;process_classes/>
        &lt;jobs>
            &lt;job name="test_job">
                &lt;script language="JavaScript">&lt;![CDATA[

                    function spooler_process()
                    {
                        spooler_log.info( "Hallo Welt!" );
                        return false;
                    }

                ]]&gt;&lt;/script>

                &lt;run_time repeat="10"/>
            &lt;/job>
        &lt;/jobs>
    &lt;/config>
&lt;/spooler></pre>

<p>
    Konfiguriert ist hier der Job <code>test_job</code>, den der Scheduler alle 10 Sekunden wiederholen wird. Wenn diese Konfiguration
    in der Datei <code>hallo_welt.xml</code> abgelegt ist, können Sie den Scheduler so starten:
</p>

<pre>scheduler hallo_welt.xml</pre>

<p>
    Sie können den Scheduler mit Ctrl-C abbrechen.
</p>



<h2>Codierung der XML-Konfiguration</h2>
<p>
    <code>&lt;?xml encoding="UTF-8"?></code>&#160; und<br/>
    <code>&lt;?xml encoding="ISO-8859-1"?></code>&#160; sind möglich.<br/>
</p>
<p>
    Der Scheduler verarbeitet nur 8bit-Zeichen (ISO-8859-1).
</p>


<h2>Schema der Konfiguration</h2>

<p>
    Der Scheduler prüft die XML-Konfiguration gegen das 
    <a href="xml/scheduler.xsd" type="text/plain" charset="utf-8">XML-Schema des Schedulers</a>.
    Das Schema können Sie sich mit der Kommandozeilenoption <scheduler_option name="show-xml-schema"/> ausgeben lassen.
</p>

<p>
    Klicken Sie auf ein Element des Schemas, um dessen Beschreibung zu sehen.
</p>

<pre>&lt;<a class="silent" href="xml/spooler.xml">spooler</a>>
    &lt;<a class="silent" href="xml/config.xml">config</a> spooler_id          = ""
            main_scheduler       = "hostname:4444"
            port                 = "4444"
            tcp_port             = "4444"
            udp_port             = "4444"
            param                = "…"
            log_dir              = "…"
            include_path         = "…"
            priority_max         = "1000"
            mail_xslt_stylesheet = "…"
            java_class_path      = "…"
            java_options         = "…"    >

        &lt;<a class="silent" href="xml/base.xml">base</a> file="…"/>

        &lt;<a class="silent" href="xml/security.xml">security</a>>
            &lt;<a class="silent" href="xml/allowed_host.xml">allowed_host</a> name="…" level="…"/>
            …
        &lt;/security>

        &lt;<a class="silent" href="xml/process_classes.xml">process_classes></a>
            &lt;<a class="silent" href="xml/process_class.xml">process_class</a> name          = "…"
                           max_processes = "…"
                           spooler_id    = "…"/>
            …
        &lt;/process_classes>

        &lt;<a class="silent" href="xml/script.xml">script</a> language   = "…"
                java_class = "…"
                com_class  = "…"
                filename   = "…" >
            &lt;<a class="silent" href="xml/include.xml">include</a> file="…"/>
            &lt;![CDATA[
                <i>programm-code</i>…
            ]]&gt;
        &lt;/script>

        &lt;<a class="silent" href="xml/web_services.xml">web_services</a>>
            &lt;<a class="silent" href="xml/web_service.xml">web_service</a> name="…" …>
                 &lt;<a class="silent" href="xml/params.xml">params</a>>
                     &lt;<a class="silent" href="xml/param.xml">param</a> name="…" value="…"/>
                     …
                 &lt;/params>
            &lt;/web_service>
            …
        &lt;/web_services>

        &lt;<a class="silent" href="xml/holidays.xml">holidays</a>>
            &lt;<a class="silent" href="xml/holiday.xml">holiday</a> day="…"/>
            …
        &lt;/holiday>

        &lt;<a class="silent" href="xml/jobs.xml">jobs></a>
            &lt;<a class="silent" href="xml/job.xml">job</a>
                force_idle_timeout = "yes|no"
                idle_timeout   = "…"
                ignore_signals = "…"
                java_options   = "…"
                min_tasks      = "…"
                name           = "…"
                order          = "no"
                priority       = "…"
                process_class  = "…"
                spooler_id     = "…"
                stop_on_error  = "yes"
                tasks          = "1"
                timeout        = "…"
                title          = "…"
                visible        = "no"
            >

                &lt;<a class="silent" href="xml/description.xml">description</a>> … &lt;/description>

                &lt;<a class="silent" href="xml/params.xml">params</a>>
                    &lt;<a class="silent" href="xml/param.xml">param</a> name="…" value="…"/>
                    …
                &lt;/params>

                &lt;<a class="silent" href="xml/script.xml">script</a> language   = "…"
                        java_class = "…"
                        com_class  = "…"
                        filename   = "…" >
                    &lt;<a class="silent" href="xml/include.xml">include</a> file="…"/>
                    &lt;![CDATA[
                        <i>programm-code</i>…
                    ]]&gt;
                &lt;/script>
              <i>oder</i>
                &lt;<a class="silent" href="xml/process.xml">process</a> file         = "…"
                         param        = ""
                         log_file     = ""
                         ignore_error = "no"
                         ignore_signal= "no" >
                    &lt;<a class="silent" href="xml/environment.xml">environment</a>>
                        &lt;<a class="silent" href="xml/variable.xml">variable</a> name  = "…"
                                  value = "…"
                        &lt;/variable>
                    &lt;/environment>
                &lt;/process>

                &lt;<a class="silent" href="xml/monitor.xml">monitor></a>
                   &lt;<a class="silent" href="xml/script.xml">script></a>…&lt;script/>
                &lt;/monitor>

                &lt;<a class="silent" href="xml/start_when_directory_changed.xml">start_when_directory_changed</a>  directory="…"  regex="…" />

                &lt;<a class="silent" href="xml/delay_after_error.xml">delay_after_error</a>  error_count="…"  delay="…" />
                 
                &lt;<a class="silent" href="xml/delay_order_after_setback.xml">delay_order_after_setback</a>  setback_count="…"  delay="…"  is_maximum="yes|no" />

                &lt;<a class="silent" href="xml/run_time.xml">run_time</a> let_run="no">
                    &lt;<a class="silent" href="xml/period.xml">period</a> let_run      = "…"
                            begin        = "00:00"
                            end          = "24:00"
                            single_start = "…"
                            repeat       = "…"     />

                    &lt;<a class="silent" href="xml/date.xml">date</a> date="yyyy-mm-dd"/>
                    …

                    &lt;<a class="silent" href="xml/weekdays.xml">weekdays</a>>
                        &lt;<a class="silent" href="xml/day.xml">day</a> day="…">
                           &lt;<a class="silent" href="xml/period.xml">period …/></a>
                            …
                        &lt;/day>
                        …
                    &lt;/weekdays>

                    &lt;<a class="silent" href="xml/monthdays.xml">monthdays</a>>
                        &lt;<a class="silent" href="xml/day.xml">day</a> day="…">
                            &lt;<a class="silent" href="xml/period.xml">period …/></a>
                            …
                        &lt;/day>
                        …
                    &lt;/monthdays>

                    &lt;<a class="silent" href="xml/ultimos.xml">ultimos</a>>
                        &lt;<a class="silent" href="xml/day.xml">day</a> day="…">
                            &lt;<a class="silent" href="xml/period.xml">period …/></a>
                            …
                        &lt;/day>
                        …
                    &lt;/ultimos>

                    &lt;<a class="silent" href="xml/holidays.xml">holidays</a>>
                        &lt;<a class="silent" href="xml/holiday.xml">holiday</a> date="yyyy-mm-dd"/>
                        …
                    &lt;/holidays>
                    
                    &lt;<a class="silent" href="xml/at.xml">at</a> at="yyyy-mm-dd HH:MM:SS"/>
                &lt;/run_time>
                 
                &lt;<a class="silent" href="xml/commands.xml">commands on_exit_code="…"</a>>
                    &lt;<a href="xml/start_job.xml">start_job</a> job="…">
                        &lt;<a href="xml/params.xml">params</a>>
                            &lt;<a href="xml/copy_params.xml">copy_params</a> from="task"/>
                            &lt;<a href="xml/copy_params.xml">copy_params</a> from="order"/>
                            …
                        &lt;/params>
                    &lt;/start_job>    
                     
                    &lt;<a href="xml/add_order.xml">add_order</a> job_chain="…">
                        &lt;<a href="xml/params.xml">params</a>>
                            &lt;<a href="xml/copy_params.xml">copy_params</a> from="task"/>
                            &lt;<a href="xml/copy_params.xml">copy_params</a> from="order"/>
                            …
                        &lt;/params>
                    &lt;/add_order>
                    …
                &lt;/commands>
            &lt;/job>
            …
        &lt;/jobs>

        &lt;<a class="silent" href="xml/job_chains.xml">job_chains</a>>
            &lt;<a class="silent" href="xml/job_chain.xml">job_chain</a> name="…"/>
                &lt;<a class="silent" href="xml/job_chain_node.xml">job_chain_node</a>  state="…"  name="…"  job="…"  next_state="…"  error_state="…"/>
                …
            &lt;/job_chain>
            …
        &lt;/job_chains>

        &lt;<a class="silent" href="xml/commands.xml">commands</a>>
            …
        &lt;/commands>

    &lt;/config>
&lt;/spooler></pre>

</description>
