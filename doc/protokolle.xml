<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet href="scheduler.xsl" type="text/xsl"?>

<!--$Id: protokolle.xml,v 1.9 2004/12/28 11:40:02 jz Exp $-->

<description 
    title    = "Protokolle" 
    base_dir = ""
    author   = "$Author: jz $"
    date     = "$Date: 2004/12/28 11:40:02 $"
>

<scheduler_keyword keyword="Protokoll"/>

<p>
    Der Scheduler schreibt seine Protokolle in das mit der Option <scheduler_option name="log-dir"/> eingestellte Verzeichnis.
</p>



<scheduler_keyword keyword="Hauptprotokoll" type="definition"/>

<h3>Hauptprotokoll</h3>
<p>
    Das Hauptprotokoll fast alle Protokolle zusammen.
    Der Dateiname wird aus Scheduler-Id, Datum und Uhrzeit gebildet, z.B. 
    <code>scheduler-2004-08-24-104111.log</code>.
</p>
    


<scheduler_keyword keyword="Jobprotokoll"/>

<h3>Jobprotokolle</h3>
<p>
    Für jeden Job erstellt der Scheduler ein Jobprotokoll
    mit den Starts der Tasks und eingetroffenen Aufträgen.
    Beispiel: <code>job.mein_job.log</code>
</p>
<p>
    Zeichen im Jobnamen, die nicht im Dateinamen verwendet werden können, tauscht der Scheduler gegen "_".
</p>



<scheduler_keyword keyword="Taskprotokoll"/>

<h3>Taskprotokolle</h3>
<p>
    Für jeden Task erstellt der Scheduler ein Taskprotokoll. 
    Der Dateiname wird aus dem Jobnamen und, wenn mehrere Tasks zugelassen sind, der Task-Id gebildet, 
    z.B.: <code>task.mein_job.log</code> und <code>task.ein_job.1234.log</code>.
    Taskprotokolle mit Task-Id werden nach Ende der Task gelöscht.
</p>
    


<scheduler_keyword keyword="Auftragsprotokoll"/>

<h3>Auftragsprotokolle</h3>
<p>
    Für jeden Auftrag erstellt der Scheduler ein Auftragsprotokoll
    mit den Ausgaben aller Tasks, die der Auftrag durchläuft.
    Der Dateiname wird aus der Jobkette und der Auftrags-Id gebildet,
    z.B.: <code>order.meine_jobkette.9876.log</code>.
    Das Auftragsprotokoll wird nach Ende des Auftrags gelöscht.
</p>



<scheduler_keyword keyword="Log-Datei"/>
<scheduler_keyword keyword="scheduler.log"/>

<h3>scheduler.log</h3>
<p>
    Zur Fehlerdiagnose kann der Scheduler das <code>scheduler.log</code> schreiben. 
    In <scheduler_ini_entry file="factory.ini" section="spooler" entry="log"/> stellen sie den Dateinamen ein.
    In dieser Dokumentation steht <code>factory.ini</code> für den hier eingestellten Dateinamen.
</p>
<p>
    Hier die <a href="log_categories.xml">Liste der Log-Kategorien</a>.
</p>


<h2>Umfang</h2>
<p>
    Mit <scheduler_option name="log-level"/> und 
    <scheduler_method class="Log" property="level" access="write" java_signature="int"/>
    kann die Stufe (error, warn, info, debug bis debug9) eingestellt werden, ab der Protokollzeilen gelten.
</p>


<scheduler_keyword keyword="Datenbank"/>

<h2>Ablage in den Datenbank</h2>

<p>
    Der Scheduler kann die Task- und Auftragsprotokolle mit in die Historie schreiben.
    Voraussetzung sind
</p>
    
<ul>
    <li>
        Betrieb mit einer <a href="datenbank.xml">Datenbank</a>, 
    </li>
    <li>
        die Einstellung <scheduler_ini_entry file="factory.ini" section="spooler" entry="history"/>), um die Historie einzuschalten,
    </li>
    <li>
        die Einstellung <scheduler_ini_entry file="factory.ini" section="spooler" entry="history_with_log"/> fürs Task-Protokoll,
    </li>
    <li>
        die Einstellung <scheduler_ini_entry file="factory.ini" section="job" entry="history_with_log"/> für bestimmte Jobs,
    </li>
    <li>
        die Einstellung <scheduler_ini_entry file="factory.ini" section="spooler" entry="order_history_with_log"/> fürs Auftragsprotokoll.
    </li>
</ul>



<h2>Programmschnittstelle</h2>
<p>
    Die Klasse <scheduler_method class="Log"/> beschreibt die Protokolle und erlaubt verschiedene Einstellungen.
</p>


<scheduler_keyword keyword="eMail-Versand"/>
<scheduler_keyword keyword="Mail-Versand"/>

<h2>eMail-Versand</h2>    

<p>
    Der Scheduler kann das Task-Protokoll per eMail verschicken. Lesen Sie weiter im Kapitel <a href="email.xml">eMail</a>.
</p>




<h2>Anzeigen der Protokolle</h2>

<p>
    Siehe Kommandos <scheduler_element name="show_state"/>, <scheduler_element name="show_task"/> und <scheduler_element name="show_history"/>.
</p>

<p>
    Mit einem Browser können Sie den eingebauten <a href="http.xml">HTTP-Server</a> ansprechen 
    und sich ein Protokoll fortlaufend anzeigen lassen.
</p>

</description>
