<?xml version="1.0"?>
<?xml-stylesheet href="changes.xsl" type="text/xsl"?>

<!--$Id$-->

<changes title    = "Änderungsprotokoll"
         author   = "$Author$"
         date     = "$Date$">

    <scheduler_keyword keyword="Änderungsprotokoll"/>
    <scheduler_keyword keyword="Change log"/>

    <change date="2006-09-14" version="2.0.158" subversion_revision="4494">
        <revision type="new" title="kill_descendants_too">
            <description>
                <p>
                    Unter Unix wird der <code>kill()</code> auf Prozesse jetzt zusätzlich mit negativer Pid ausgeführt,
                    um die ganze Prozessgruppe zu beenden.
                </p>
                <ul>
                    <li>
                        <scheduler_method class="Subprocess" property="new_process_group"/>
                    </li>
                </ul>
            </description>
        </revision>

        <revision type="new" title="Mail-Versand nur in Dateiverzeichnis">
            <description>
                <p>
                    <code>smtp=-queue</code> verhindert den Versand und stellt die Nachricht in das mit
                    <scheduler_ini_entry file="sos.ini" section="spooler" entry="queue_dir"/>                    
                    eingestellte Verzeichnis.
                </p>
                <ul>
                    <li>
                        <scheduler_ini_entry file="factory.ini" section="spooler" entry="smtp"/>
                    </li>
                    <li>
                        <scheduler_ini_entry file="sos.ini" section="spooler" entry="smtp"/>
                    </li>
                </ul>
            </description>
        </revision>
    </change>
    
    <change date="2006-09-13" version="2.0.158" subversion_revision="4484">

        <revision type="correction" title="Doppelte Einträge in spooler_task.changed_directories">
            <description>
                <p>
                    <scheduler_method class="Task" properties="changed_directories"/>
                    konnte mehrfache Einträge enthalten, 
                    wenn der Scheduler mehrfache Änderungen desselben Verzeichnisses bemerkte,
                    Verzeichnisänderungen bemerkt, bevor die Task gestartet werden konnte.
                    Jetzt wird jedes Verzeichnis nur einmal eingetragen.
                </p>
            </description>
        </revision>

        <revision type="new" title="&lt;process> gibt bei Prozessstart Kommandozeile aus">
            <description>
                <ul>
                    <li>
                        <scheduler_element name="process"/>
                    </li>
                    <li>
                        <scheduler_message level="info" code="SCHEDULER-987" show_text="yes"/>
                    </li>
                </ul>
            </description>
        </revision>

        <revision type="new" title="spooler_log.mail.to etc. liefern Default-Werte">
            <description>
                <p>
                    Folgende Aufruf liefern die Default-Werte aus den .ini-Dateien:
                </p>
                <ul>
                    <li>
                        <scheduler_method class="Mail" object="spooler_log.mail" property="from"/>
                    </li>
                    <li>
                        <scheduler_method class="Mail" object="spooler_log.mail" property="to"/>
                    </li>
                    <li>
                        <scheduler_method class="Mail" object="spooler_log.mail" property="cc"/>
                    </li>
                    <li>
                        <scheduler_method class="Mail" object="spooler_log.mail" property="bcc"/>
                    </li>
                    <li>
                        <scheduler_method class="Mail" object="spooler_log.mail" property="subject"/>
                    </li>
                    <li>
                        <scheduler_method class="Mail" object="spooler_log.mail" property="smtp"/>
                    </li>
                    <li>
                        <scheduler_method class="Mail" object="spooler_log.mail" property="queue_dir"/>
                    </li>
                </ul>
            </description>
        </revision>
        
        <revision type="new" title="Web_service_operation.peer_ip und .peer_hostname">
            <description>
                Zwei neue Aufrufe:

                <ul>
                    <li>
                        <scheduler_method class="Web_service_operation" property="peer_ip"/>
                    </li>
                    <li>
                        <scheduler_method class="Web_service_operation" property="peer_hostname"/>
                    </li>
                </ul>
            </description>
        </revision>

        <revision type="new" title="Dateiaufträge">
            <description>
                In <scheduler_element name="job_chain"/> können zwei neue XML-Elemente angegeben werden:

                <ul>
                    <li>
                        <scheduler_element name="file_order_source"/>
                    </li>
                    <li>
                        <scheduler_element name="file_order_sink"/>
                    </li>
                    <li>
                        <scheduler_element name="show_job_chains" attribut="what" value="blacklist"/>
                    </li>
                </ul>
            </description>
        </revision>
    </change>


    <change date="2006-08-30" version="2.0.157" subversion_revision="4442">
        <revision type="correction" title="&lt;show_state what=&quot;job_commands&quot; liefert alle &lt;commands>">
            <description>
                Bisher lieferte der Scheduler nur das erste <scheduler_element name="commands"/> eines Jobs.
            </description>
        </revision>
    </change>


    <change date="2006-08-25" version="2.0.157" subversion_revision="4439">
        <revision type="modification" title="-send-cmd=... liefert Ausgabe ohne Null-Byte">
            <description>
                <ul>
                    <li>
                        <scheduler_option name="send-cmd"/> gibt die Antwort des Schedulers ohne das über TCP übertragene Nullbyte aus.
                        Damit wird nach stdout ein wohlgeformtes XML-Dokument geschrieben.
                    </li>
                </ul>
            </description>
        </revision>
    </change>


    <change date="2006-08-25" version="2.0.157" subversion_revision="4436">
        <revision type="correction" title="Subprocess.start( String[] ) für Java funktioniert">
            <description>
                <ul>
                    <li>
                        <scheduler_method class="Subprocess" method="start"/> funktionierte in Java nicht
                        mit einem String-Array.
                        Das ist behoben.
                    </li>
                </ul>
            </description>
        </revision>
    </change>

    
    <change date="2006-08-18" version="2.0.157" subversion_revision="4424">
        <revision type="new" title="&lt;job stop_on_error=&quot;no&quot;>">
            <description>
                <ul>
                    <li>
                        <scheduler_element name="job" attribute="stop_on_error" value="no"/>
                        verhindert den Stopp des Jobs wegen einer Fehlermeldung einer Task.
                        Bei <scheduler_option name="log-level" value="debug3"/> gibt der Scheduler am
                        Ende einer fehlerhaften Task die Meldungen 
                        <scheduler_message code="SCHEDULER-977"/> oder <scheduler_message code="SCHEDULER-978"/> aus.
                    </li>
                </ul>
            </description>
        </revision>

        <revision type="new" title="spooler_task.trigger_files">
            <description>
                <ul>
                    <li>
                        <scheduler_method class="Task" property="trigger_files"/>
                    </li>
                    <li>
                        <scheduler_element name="process"/>: 
                        Dem Prozess wird die Umgebungsvariable <code>SCHEDULER_TASK_TRIGGER_FILES</code> übergeben.
                    </li>
                </ul>
            </description>
        </revision>

        <revision type="correction" title="&lt;environment>: Originalgroßschreibung der Umgebungsvariablennamen">
            <description>
                <p>
                    Der Scheduler setzte die Umgebungsvariablennamen in Kleinschreibung.
                    Jetzt verwendet er die Schreibung wie in <scheduler_element name="environment"/> angegeben.
                    Unter Windows hat das keine Auswirkung, weil die Schreibung keine Rolle spielt.
                </p>
            </description>
        </revision>

        <revision type="correction" title="Aufträge mit &lt;period repeat=&quot;...&quot;>: jeder zweite Tag wurde ausgelassen">
            <description>
                <p>
                Wenn der Scheduler als nächsten Startzeit mit <code>repeat=</code> eine Startzeit errechnete,
                    die außerhalb der Periode lag (immer nach Mitternacht), dann nahm er die auf die errechnete Startzeit folgende Periode,
                    die aber nicht die nächste, sondern die übernächste ist.
                </p>
                <p>
                    Bei einem einfachen <scheduler_element name="run_time" attribute="period" value="300"/>
                    führte das um Mitternacht zum Überspringen des folgenden Tags.
                    Das ist korrigiert.
                    Der Scheduler ermittelt die folgende Periode aus der Endzeit der aktuellen Periode.
                </p>
            </description>
        </revision>

    </change>        

    <change date="2006-08-09" version="2.0.156" subversion_revision="4406">
        <revision type="modification" title="Signal einer abgebrochenen Task wird auch bei nicht &lt;process&gt;-Jobs zum negativen Exit code">
            <description>
                <p>
                    Nur Unix:
                    Bisher ist das Signal einer abgebrochenen Task nur bei <scheduler_element name="process"/>-Jobs als 
                    negativer Exit-Code übernommen worden.
                    Jetzt gilt das für alle Jobs.
                </p>
            </description>
        </revision>
        
        <revision type="new" title="&lt;job ignore_signals=&quot;...&quot;&gt;">
            <description>
                <p>
                    Eine Task, die mit Signal endet (durch <code>kill</code> oder Absturz),
                    muss nicht mehr zum Stopp des Jobs führen.
                </p>
                <ul>
                    <li>
                        <scheduler_element name="job" attribute="ignore_signals" value="SIGTERM SIGKILL ..."/>
                    </li>
                </ul>
            </description>
        </revision>

        <revision type="new" title="&lt;commands on_exit_code=&quot;SIGTERM&quot;&gt;">
            <description>
                <p>
                    Nur Unix: Die Signalnamen können aufgeführt werden.
                </p>
                <ul>
                    <li>
                        <scheduler_element name="commands" attribute="on_exit_code" value="SIGTERM SIGKILL ..."/>
                    </li>
                    <li>
                        <scheduler_element name="commands" attribute="on_exit_code" value="signal"/>
                    </li>
                </ul>
            </description>
        </revision>
    </change>


    <change date="2006-07-27" version="2.0.155" subversion_revision="4396">
        <revision type="new" title="&lt;show_job what=&quot;job_commands&quot;&gt;">
            <description>
                <p>
                    Mit dem Attribut <code>what="job_commands"</code> liefern die Kommandos,
                    die das Element <scheduler_element directory="xml/answer/" name="job"/> zeigen,
                    auch das Element <scheduler_element name="commands"/> der Job-Konfiguration.
                </p>
                <ul>
                    <li>
                        <scheduler_element name="show_job" attribute="what" value="job_commands"/>
                    </li>
                    <li>
                        <scheduler_element name="show_jobs" attribute="what" value="job_commands"/>
                    </li>
                    <li>
                        <scheduler_element name="show_job_chains" attribute="what" value="job_commands"/>
                    </li>
                    <li>
                        <scheduler_element name="show_state" attribute="what" value="job_commands"/>
                    </li>
                </ul>
            </description>
        </revision>
    </change>


    <change date="2006-07-27" version="2.0.154" subversion_revision="4393">
        <revision type="correction" title="Datenbankzugriffe auf die Tabelle scheduler_orders">
            <description>
                <p>
                    Der Primärschlüssel der Tabelle <code>SCHEDULER_ORDERS</code> 
                    ist um <code>SPOOLER_ID</code> erweitert.
                    Alle Where-Klauseln auf diese Tabelle sind um <code>SPOOLER_ID</code> und <code>JOB_CHAIN</code> ergänzt worden.
                </p>
                <p>
                    Clob <code>RUN_TIME</code> wird nur noch bei gefüllter <code>run_time</code> gesetzt.
                </p>
            </description>
        </revision>
    </change>


    <change date="2006-06-30" version="2.0.154" subversion_revision="4390">
        <revision type="correction" title="Java-Job ohne Konstruktor">
            <description>
                <p>
                    Ein Java-Job ohne parameterlosen Konstruktor führte zum Abbruch des Prozesses
                    statt zur Exception <code>java.lang.NoSuchMethodError</code>.
                </p>
            </description>
        </revision>

        <revision type="correction" title="&lt;config java_class_path=&quot;&quot;>">
            <description>
                <p>
                    Das Attribut <code>java_class_path</code> wurde im Betrieb mit Prozessklassen nicht ausgewertet.
                </p>
                <ul>
                    <li>
                        <scheduler_element name="config" attribute="java_class_path"/>
                    </li>
                </ul>
            </description>
        </revision>
    </change>

    <change date="2006-06-20" version="2.0.154" subversion_revision="4379">

        <revision type="correction" title="history_on_process verhält sich jetzt wie dokumentiert">
            <description>
                <p>
                    Eine falsche Angabe wird nicht mehr ignoriert, sondern führt zum Fehler.
                </p>
                <ul>
                    <li>
                        <scheduler_ini_entry file="factory.ini" section="job" entry="history_on_process"/>
                    </li>
                </ul>
            </description>
        </revision>
    </change>
        
    <change date="2006-06-19" version="2.0.154" subversion_revision="4366">

        <revision type="new" title="Ein paar Verbesserungen in der internen Ereignisverarbeitung">
            <description>
                <p>
                    Neues Attribut <code>wait_until</code> liefert den Zeitpunkt der nächsten geplanten Aktion.
                    Nach etwa 20 Minuten Nichtstun gibt der Scheduler eine Meldung aus, 
                    bis wann und worauf er wartet.
                </p>

                <ul>
                    <li>
                        <scheduler_element directory="xml/answer/" name="state" attribute="wait_until"/>
                    </li>
                    <li>
                        <scheduler_message code="SCHEDULER-972"/>
                    </li>
                </ul>
            </description>
        </revision>
        
        <revision type="correction" title="&lt;show_state> lieferte Fehler bei beendeten Subprozess, deshalb evt. keine eMail">
            <description>
                <p>
                    <scheduler_element name="show_state"/> und andere Kommandos, die den Task-Zustand zeigen,
                    lieferte einen Fehler, wenn ein Subprozess oder der Task-Prozess selbst beendet war
                    und der Scheduler dies noch nicht zur Kenntnis genommmen hatte.
                    Grund: Der Systemaufruf zum Lesen der Priorität liefert einen Fehler.
                </p>
                <p>
                    Das konnte insbesondere bei <scheduler_element name="kill_task"/> mit Subprozess dazu führen, 
                    dass die eMail am Ende der Task nicht versendet und 
                    statt dessen der Fehler <scheduler_message code="SCHEDULER-302"/> ausgegeben wird.
                </p>
                <ul>
                    <li>
                        <scheduler_element name="kill_task"/>
                    </li>
                    <li>
                        <scheduler_element directory="xml/answer/" name="subprocess" attribute="priority"/>
                    </li>
                    <li>
                        <scheduler_method class="Log" property="mail_on_error"/>
                    </li>
                </ul>
            </description>
        </revision>
    </change>
    
    <change date="2006-06-16" version="2.0.154" subversion_revision="4352">

        <revision type="new" title="&lt;process param=&quot;&quot;>: Task-Parameter werden ersetzt">
            <description>
                <p>
                    Im Attribut <code>param=</code> ersetzt der Scheduler jetzt auch Task-Parameter.
                    Die haben Vorrang vor den Umgebungsvariablen.
                    Damit kann für jede Task eine andere Parameterzeile übergeben werden.
                </p>
                <ul>
                    <li>
                        <scheduler_element name="process" attribute="param"/>
                    </li>
                </ul>
            </description>
        </revision>

        <revision type="new" title="Neue Eigenschaft Order.at">
            <description>
                <ul>
                    <li>
                        <scheduler_method class="Order" property="at"/>
                    </li>
                </ul>
            </description>
        </revision>

        <revision type="new" title="Strg-C bricht nicht mehr die Prozesse ab">
            <description>
                <p>
                    Strg-C wirkt nur noch auf den Scheduler-Prozess, 
                    aber nicht mehr auf die Task-Prozesse 
                    (außer unter Windows <scheduler_element name="process"/> und <scheduler_element name="script" language="shell" />).
                    Damit kann der Scheduler nach Strg-C die Tasks ordentlich beenden.
                    Ein zweites Strg-C führt nach wie vor zum sofortigen Ende aller Tasks und des Schedulers.
                </p>
            </description>
        </revision>

    </change>

    <change date="2006-06-06" version="2.0.154" subversion_revision="4339">

        <revision type="correction" title="-env= korrigiert (Windows)">
            <description>
                <p>
                    <code>-env=</code> hat die Variablen für Kindprozesse gesetzt, aber nicht für den eigenen.
                    (Das wird nämlich von Microsofts C unterschieden.)
                </p>
                <ul>
                    <li>
                        <scheduler_option name="env"/>
                    </li>
                </ul>
            </description>
        </revision>

        <revision type="correction" title="&lt;add_order replace=&quot;yes&quot;>">
            <description>
                <p>
                    Das XML-Schema erlaubt jetzt replace="yes".
                </p>
                <ul>
                    <li>
                        <scheduler_element name="add_order" attribute="replace"/>
                    </li>
                </ul>
            </description>
        </revision>

        <revision type="new" title="Neue Option -expand-classpath=">
            <description>
                <p>
                    Expandiert den als Parameter angegebenen Java-Classpath,
                    d.h. die Joker werden verarbeitet wie in <scheduler_ini_entry file="sos.ini" section="java" entry="class_path"/>.
                </p>
                <ul>
                    <li>
                        <scheduler_option name="expand-classpath"/>
                    </li>
                </ul>
            </description>
        </revision>

        <revision type="new" title="&lt;commands on_exit_code=&quot;0&quot;>">
            <description>
                <ul>
                    <li>
                        Neue Eigenschaft <scheduler_method class="Task" property="exit_code"/> (int), anfänglich 0.
                        <scheduler_method class="Log" object="spooler_log" method="error"/>,
                        <scheduler_method class="Task" object="spooler_task" method="error"/> oder
                        eine Exception der Task setzen
                        <scheduler_method class="Log" object="spooler_task" property="exit_code"/><code>=1</code>.
                        <code>exit_code</code> kann auch vom Job selbst gesetzt werden,
                        wird aber unter den oben aufgeführten Bedingungen vom Scheduler überschrieben.
                        Damit liefert jede im Scheduler mögliche Task am Ende einen <code>exit_code</code>.
                    </li>
                    <li>
                        Der <code>exit_code</code> wird in die Datenbanktabelle <code>scheduler_history</code> 
                        in die neue Spalte <code>exit_code</code> geschrieben,
                        die der Scheduler automatisch anlegt.
                    </li>
                    <li>
                        Unter Unix liefert ein abgebrochener Prozess die Nummer des Signals negativ als Exit-Code.
                    </li>
                    <li>
                        <scheduler_element name="job"/> wird um <scheduler_element name="commands" attribute="on_exit_code"/> erweitert.

                        Für das Attribut <code>on_exit_code</code> kann eine Folge von Exit-Codes,
                        <code>"success"</code> (dasselbe wie <code>0</code>) oder
                        <code>"error"</code> angegeben werden.
                        Letztere Einstellung gilt für alle Exit-Codes außer 0, die nicht in anderen
                        <scheduler_element name="commands" attribute="on_exit_code"/> aufgeführt sind.
                        Jedem Exit-Code ist damit nicht mehr als ein <scheduler_element name="commands"/> zugeordnet.
                    </li>
                    <!--li>
                        Ein Fehler im Kommando führt zum Job-Fehler: 
                        Der Job wird gestoppt, außer <scheduler_element name="delay_after_error"/> ist gesetzt
                        (<scheduler_element name="process" attribute="ignore_error" value="yes"/> wirkt hier nicht, sondern nur auf Exitcodes).
                    </li-->
                    <li>
                        Ein Fehler bei der Kommando-Ausführung verhindert die Ausführung der folgenden Kommandos und wird zur Task protokolliert.
                        Der Job wird gestoppt.
                    </li>
                    <li>
                        <scheduler_element name="commands"/> darf leer sein.
                    </li>
                </ul>
            </description>

            <revision type="new" title="Anlässe zum Start einer Task 'queue' und 'queue_at'">
                <description>
                    <p>
                        Diese Anlässe werden jetzt auch protokolliert (mit <scheduler_message code="SCHEDULER-930"/>).
                    </p>
                </description>
            </revision>

            <revision type="correction" title="Speicherlecks beim Aufruf von Spidermonkey abgedichtet">
                <description>
                    <p>
                        Betrifft <code>spidermonkey.dll</code> und <code>libspidermmonkey.so</code>.
                    </p>
                </description>
            </revision>

        </revision>

        <revision type="new" title="&lt;copy_params>">
            <description>
                <p>
                    <scheduler_element name="params"/> erhält das neue Kind-Element
                    <scheduler_element name="copy_params" attribute="from"/>.
                    Es kann nur unter <scheduler_element name="job" child="commands"/>
                    in <scheduler_element name="start_job" child="params"/> und
                    <scheduler_element name="add_order" child="params"/> verwendet werden und
                    kopiert an seine Stelle die Parameter der Task oder des Auftrags.
                </p>
                <p>
                    <scheduler_element name="copy_params" attribute="from" value="order"/> ist ein Fehler, wenn es keinen Auftrag gibt.
                </p>
            </description>
        </revision>

        <revision type="new" title="Aufträge mit Startzeit">
            <description>
                <p>
                    Aufträge können einen Startzeit haben, 
                    die in der Datenbank gespeichert wird und somit bei Scheduler-Neustart erhalten bleibt.
                    Ein noch nicht ausgeführter Auftrag mit verstrichener Startzeit wird sofort gestartet
                    (sofern die <scheduler_element name="run_time"/> des Jobs dies erlaubt).
                </p>
                <p>
                    Das entspricht dem Verhalten von <scheduler_element name="start_job" attribute="at"/>.
                </p>
                <ul>
                    <li>
                        <scheduler_element name="add_order" attribute="at"/>
                    </li>
                </ul>
            </description>
        </revision>

        <revision type="new" title="Relative Zeitangabe mit now+HH:MM">
            <description>
                <ul>
                    <li>
                        <scheduler_element name="start_job" attribute="at" value="now+..."/>
                    </li>
                    <li>
                        <scheduler_element name="add_order" attribute="at" value="now+..."/>
                    </li>
                </ul>
                <p>
                    Mögliche Angaben sind:
                </p>
                <ul>
                    <li>
                        <code>now</code>
                    </li>
                    <li>
                        <code>now + </code>
                        <i>seconds</i>
                    </li>
                    <li>
                        <code>now + </code>
                        <i>hh:mm</i>
                    </li>
                    <li>
                        <code>now + </code>
                        <i>hh:mm:ss</i>
                    </li>
                    <li>
                        <code>yyyy-mm-dd HH:MM</code>
                    </li>
                    <li>
                        <code>yyyy-mm-dd HH:MM:SS</code>
                    </li>
                </ul>
            </description>
        </revision>

        <revision type="correction" title="language=&quot;perl&quot; unter Windows">
            <description>
                <p>
                    Unter Windows übergab der Scheduler nur bei
                    <scheduler_element name="script" attribute="language" value="perlscript"/> die folgende Anweisung:
                </p>
                <pre>Win32::OLE->Option( Warn => 3 );</pre>
                <p>
                    <scheduler_element name="script" attribute="language" value="perl"/> hat jetzt dasselbe Verhalten.
                    Damit ignoriert Perl nicht länger einen Fehler bei einem Aufruf einer Scheduler-Methode.
                </p>
            </description>
        </revision>
    </change>

    <change date="2006-05-29" version="2.0.153" subversion_revision="4313">
        <revision type="new" title="Joker im Java-Classpath">
            <description>
                <pre>class_path = c:\directory\sos.*.jar;...</pre>
                <ul>
                    <li>
                        <scheduler_ini_entry file="sos.ini" section="java" entry="class_path"/>
                    </li>
                </ul>
            </description>
        </revision>
    </change>
                   
    <change date="2006-05-26" version="2.0.151" subversion_revision="4305">
        <revision type="new" title="Umgebungsvariablen mit ${name}">
            <description>
                <p>
                    Dort, wo Umgebungsvariablen mit <code>$</code><i>name</i> aufgerufen werden können,
                    kann jetzt auch <code>${</code><i>name</i><code>}</code> geschrieben werden.
                    Damit ist die Trennung zum anschließenden Text deutlicher.
                </p>
            </description>
        </revision>

        <revision type="modification" title="In &lt;base file=&quot;&quot;> und &lt;include file=&quot;&quot;> lassen sich Umgebungsvariablen nutzen">
            <description>
                <ul>
                    <li>
                        <scheduler_element name="base" attribute="file"/>
                    </li>
                    <li>
                        <scheduler_element name="include" attribute="file"/>
                    </li>
                </ul>
            </description>
        </revision>

        <revision type="new" title="Umgebungsvariablen mit ${name}">
            <description>
                <p>
                    Dort, wo bisher Umgebungsvariablen mit <code>$</code><i>name</i> aufgerufen werden können,
                    kann jetzt auch <code>${</code><i>name</i><code>}</code> geschrieben werden.
                    Damit ist die Trennung zum anschließenden Text deutlicher.
                </p>
            </description>
        </revision>

        <revision type="correction" title="spooler_task.params korrigiert">
            <description>
                <p>
                    Der Aufruf konnte zum Abbruch des Schedulers führen.
                </p>
                <ul>
                    <li>
                        <scheduler_method class="Variable_set" property="names"/>
                    </li>
                </ul>
            </description>
        </revision>
    </change>

    <change date="2006-05-26" version="2.0.151" subversion_revision="4304">
        <revision type="new" title="&lt;job min_tasks=...>">
            <description>
                <p>
                    Der Scheduler kann dafür sorgen, dass eine minimale Anzahl Tasks läuft.
                </p>
                <ul>
                    <li>
                        <scheduler_element name="job" attribute="min_tasks"/>
                    </li>
                </ul>
            </description>
        </revision>

        <revision type="correction" title="Subprocess.wait_for_termination(int) funktioniert jetzt unter Unix">
            <description>
                <p>
                    Unter Unix wurde der Parameter für die Wartezeit ignoriert. Das ist behoben.
                </p>
                <ul>
                    <li>
                        <scheduler_method class="Subprocess" method="wait_for_termination"/>
                    </li>
                </ul>
            </description>
        </revision>

        <revision type="new" title="Perl-Schnittstelle unter Unix um Objekt- und Array-Parameter erweitert">
            <description>
                <p>
                    Die Perl-Schnittstelle nimmt damit auch unter Unix die folgenden Aufrufe an:
                </p>
                <ul>
                    <li>
                        <scheduler_method class="Spooler" method="add_job_chain" programming_language="perl"/>
                    </li>
                    <li>
                        <scheduler_method class="Job_chain" method="add_order" programming_language="perl"/>
                    </li>
                    <li>
                        <scheduler_method class="Order" property="params" programming_language="perl"/>
                    </li>
                    <li>
                        <scheduler_method class="Task" method="create_subprocess" programming_language="perl"/>
                    </li>
                    <li>
                        <scheduler_method class="Subprocess" method="start" programming_language="perl"/>
                    </li>
                </ul>
                <p>
                    Betrifft die Datei <code>libsosperlscript.so</code>.
                </p>
            </description>
        </revision>

        <revision type="correction" title="Neuer Auftrag mit Startzeit weckt schlafende Task">
            <description>
                <p>
                    Ein Auftrag mit Startzeit weckt jetzt eine schlafende Task (im Zustand running_waiting_for_order),
                    sodass der Auftrag sofort zur Startzeit ausgeführt wird.
                </p>
            </description>
        </revision>
    </change>

    <!--change date="2006-04-17" version="2.0.151" subversion_revision="4277">
        <revision type="correction" title="Dokumentation geändert: Objekte und Arrays können in Perl unter Unix nicht als Parameter übergeben werden">
            <description>
                <ul>
                    <li>
                        <scheduler_method class="Job_chain" method="add_order"/>
                    </li>
                    <li>
                        <scheduler_method class="Spooler" method="add_job_chain"/>
                    </li>
                    <li>
                        <scheduler_method class="Order" property="params"/>
                    </li>
                </ul>
                <p>
                    (Klick auf der API-Seite oben auf Perl!)
                </p>
            </description>
        </revision>
    </change-->
    
    <change date="2006-04-13" version="2.0.151" subversion_revision="4254">
        <revision type="new" title="Neue Option -env=NAME=WERT">
            <description>
                <ul>
                    <li>
                        <scheduler_option name="env" value="NAME=VALUE"/>
                    </li>
                    <li>
                        <scheduler_option name="sos.ini"/> setzt die Umgebungsvariable <code>SOS_INI</code>.
                    </li>
                </ul>
            </description>
        </revision>

        <revision type="modification" title="Verhalten bei Fehler von &lt;start_when_directory_changed&gt; geändert">
            <description>
                <p>
                    Bisher wurde die Verzeichnisüberwachung beim Start jeder Task wiederholt.
                    Bei einem Fehler in der Verzeichnisüberwachung 
                    (z.B. weil das Verzeichnis entfernt worden war)
                    wurde der Job gestoppt, während die Task zuende laufen konnte,
                    und keine weitere Task wurde mehr gestartet.
                </p>
                <p>
                    Jetzt stoppt der Scheduler den Job nicht mehr direkt.
                    Die Verzeichnisüberwachung wird am Ende der Task 
                    (nach <scheduler_method class="Job_impl" method="spooler_exit"/>)
                    wiederholt.
                    Ein Fehler dabei führt zum Stopp des Jobs, 
                    der aber mit <scheduler_element name="delay_after_error"/> abgefangen werden kann.
                </p>
                <ul>
                    <li>
                        <scheduler_element name="start_when_directory_changed"/>
                    </li>
                </ul>
            </description>
        </revision>

        <revision type="new" title="Web-Service-Parameter werden in XSLT-Stylesheets übernommen">
            <description>
                <p>
                    Parameter, die Apostroph und Anführungszeichen enthalten, werden mit Warnung abgewiesen, 
                    da offenbar solche Werte <a href="http://xmlsoft.org/XSLT/">libxslt</a> nicht übergeben werden können.
                </p>
                <ul>
                    <li>
                        <scheduler_element name="web_service" child="params"/>
                    </li>
                </ul>
            </description>
        </revision>
    </change>

    <change date="2006-04-12" version="2.0.151" subversion_revision="4253">
        <revision type="new" title="Neue Eigenschaft Order.params">
            <description>
                <ul>
                    <li>
                        <scheduler_method class="Order" property="params"/>
                    </li>
                </ul>
            </description>
        </revision>

        <revision type="new" title="Web-Service-Parameter werden in XSLT-Stylesheets übernommen">
            <description>
                <p>
                    Parameter, die Apostroph und Anführungszeichen enthalten, werden mit Warnung abgewiesen, 
                    da offenbar solche Werte <a href="http://xmlsoft.org/XSLT/">libxslt</a> nicht übergeben werden können.
                </p>
                <ul>
                    <li>
                        <scheduler_element name="web_service" child="params"/>
                    </li>
                </ul>
            </description>
        </revision>
    </change>

    <change date="2006-04-06" version="2.0.150" subversion_revision="4240">
        <revision type="correction" title="Schema erlaubt wieder &lt;delay_after_error delay=&quot;stop&quot;&gt;">
            <description>
                <ul>
                    <li>
                        <scheduler_element name="delay_after_error" attribute="delay" value="stop"/>
                    </li>
                </ul>
            </description>
        </revision>
    </change>

    <change date="2006-04-04" version="2.0.150" subversion_revision="4233">
        <revision type="new" title="command_line.xml neu strukturiert">
            <description>
                scheduler_client entfällt wieder. 
                Die Optionen sind im Programm scheduler integriert.
                Die verschiedenen Aufrufe des Schedulers sind jetzt dokumentiert,
                siehe z.B. <a href="command_line.xml#options__start_job">"Laufendem Scheduler einen Job übergeben"</a>.
            </description>
        </revision>
    </change>

    <change date="2006-03-31" version="2.0.150" subversion_revision="4225">
        <revision type="new" title="scheduler.xsd auf ISO-8859-1 begrenzt">
            <description>
                XML-Kommandos können nur Zeichen aus ISO-8859-1 enthalten.
            </description>
        </revision>

        <revision type="new" title="Prozess-Prioritäten">
            <description>
                <ul>
                    <li>
                        <scheduler_element name="job" attribute="priority" value="below_normal"/>
                    </li>
                    <li>
                        <scheduler_method class="Task" property="priority"/>
                    </li>
                    <li>
                        <scheduler_method class="Task" property="priority_class"/>
                    </li>
                    <li>
                        <scheduler_method class="Subprocess" property="priority"/>
                    </li>
                    <li>
                        <scheduler_method class="Subprocess" property="priority_class"/>
                    </li>
                </ul>
            </description>
        </revision>
    </change>

    <change date="2006-03-25" version="2.0.149" subversion_revision="4218">
        <revision type="new" title="scheduler_client">
            <description>
                <p>
                    Das neue Programm <code>scheduler_client</code> kann dem Scheduler Jobs und Aufträge übergeben.
                </p>
                <p>
                    Start eines Jobs, dessen Skript über <code>stdin</code> übergeben wird:
                </p>
                <div class="indent">
                    <code>scheduler_client </code>
                    <code>-scheduler=</code><i>host</i><code>:</code><i>port</i> &#160;
                    <code>-language=</code><i>script_language</i> &#160;
                    <code>-process_class=</code><i>process_class</i> &#160;
                    <code>-at=</code>"<i>yyyy-mm-dd HH:MM</i>" &#160;
                </div>
                <p>
                    Übergabe eines Auftrags:
                </p>
                <div class="indent">
                    <code>scheduler_client </code>
                    <code>-scheduler=</code><i>host</i><code>:</code><i>port</i> &#160;
                    <code>-job-chain=</code><i>job_chain</i> &#160;
                    <code>-order-id=</code><i>order_id</i> &#160;
                    <code>-at=</code>"<i>yyyy-mm-dd HH:MM</i>" &#160;
                    <i>parameter</i><code>=</code><i>value</i> …
                </div>
            </description>
        </revision>

        <revision type="modification" title="&lt;job temporary=&quot;true&quot;&gt;">
            <description>
                <p>
                    Ein temporärer Job wird erst gelöscht, 
                    wenn die <scheduler_element name="run_time"/> keine Startzeit mehr vorsieht
                    und die Task-Warteschlange leer ist.
                </p>
            </description>
        </revision>

        <revision type="new" title="&lt;script language=&quot;shell&quot;&gt;">
            <description>
                <p>
                    Neue Skript-Sprache "shell" erlaubt es, 
                    Shell-Jobs in der XML-Konfiguration anzugeben.
                    (Für scheduler_client)
                </p>
                <ul>
                    <li>
                        <scheduler_element name="script" attribute="language" value="shell"/>
                    </li>
                </ul>
            </description>
        </revision>

        <revision type="new" title="Neue Angabe für &lt;run_time&gt;: &lt;at&gt;">
            <description>
                <ul>
                    <li>
                        <scheduler_element name="at" attribute="at" value="2006-03-24 12:00"/>
                    </li>
                </ul>
            </description>
        </revision>
    </change>

    <change date="2006-03-17" version="2.0.148" subversion_revision="4199">
        <revision type="correction" title="Der Scheduler läuft wieder unter Windows 2000">
            <description>
                <p>
                    Die fehlerhafte Routine SafeArrayGetVartype() in Windows 2000 wird umgegangen.
                </p>
            </description>
        </revision>
    </change>
    
    <change date="2006-03-10" version="2.0.148" subversion_revision="4178">
        <revision type="new" title="&lt;web_service> mit &lt;params>">
            <description>
                Einem Web-Service lassen sich Parameter geben, die in den Jobs gelesen werden können.
                <ul>
                    <li>
                        <scheduler_element name="web_service"/>
                    </li>
                    <li>
                        <scheduler_method class="Web_service" property="params"/>
                    </li>
                </ul>
            </description>
        </revision>

        <revision type="new" title="Meldungen ins Englische übersetzt und mit Codes versehen">
            <description>
                Die Meldungen (außer einige Debug-Meldungen) sind jetzt codiert, wie z.B. "<code>SCHEDULER-900 Scheduler is starting ...</code>".
                <ul>
                    <li>
                        <a href="messages/index.xml">Liste der Meldungs-Codes</a>
                    </li>
                </ul>
            </description>
        </revision>

        <revision type="new" title="Neue Eigenschaften Request|Response.content_type und .charset_name">
            <description>
                <ul>
                    <li>
                        <scheduler_method class="Web_service_request" property="content_type"/>
                    </li>
                    <li>
                        <scheduler_method class="Web_service_request" property="charset_name"/>
                    </li>
                    <li>
                        <scheduler_method class="Web_service_response" property="content_type"/>
                    </li>
                    <li>
                        <scheduler_method class="Web_service_response" property="charset_name"/>
                    </li>
                </ul>
            </description>
        </revision>
    </change>

    <change date="2006-03-05" version="2.0.148" subversion_revision="4155">
        <revision type="new" title="&lt;job_chain orders_recoverable=&quot;no&quot;&gt;">
            <description>
                <ul>
                    <li>
                        <scheduler_element name="job_chain" attribute="orders_recoverable" value="no"/>
                    </li>
                    <li>
                        <scheduler_method class="Job_chain" property="orders_recoverable"/>
                    </li>
                </ul>
            </description>
        </revision>

        <revision type="new" title="&lt;script java_class=&quot;–&quot;&gt; ist überschreibbar">
            <description>
                <ul>
                    <li>
                        <scheduler_element name="script" attribute="java_class"/>
                    </li>
                </ul>
            </description>
        </revision>
    </change>
    
    <change date="2006-03-01" version="2.0.148" subversion_revision="4126">
        <revision type="new" title="Neuer C++-Compiler für Windows">
            <description>
                <p>
                    Ab Revision 4126 ist alle Software für Windows mit Microsoft Visual Studio 2005 C++ übersetzt.
                    Es sollte keine Änderung bemerkbar sein.
                </p>
            </description>
        </revision>

        <revision type="new" title="XML-Schema eingeführt">
            <description>
                <p>
                    Die XML-Konfiguration und die XML-Kommandos werden gegen ein eingebautes XML-Schema geprüft.
                    Die neue Option <scheduler_option name="show-xml-schema"/> liefert das XML-Schema.
                    Zum Test ist eine aktuelle Version übers Internet erreichbar:
                    <a href="http://www.zschimmer.com/2006/scheduler.xsd">http://www.zschimmer.com/2006/scheduler.xsd</a>.
                </p>
                <p>Neue Kommandozeilen-Optionen:</p>
                <ul>
                    <li>
                        <scheduler_option name="show-xml-schema"/>
                    </li>
                    <li>
                        <scheduler_option name="validate-xml"/>
                    </li>
                </ul>
            </description>
        </revision>

        <revision type="new" title="Neue Eigenschaft order.xml_payload">
            <description>
                <p>
                    Zusätzlich zur payload kann <scheduler_method class="Order" property="xml_payload"/> ein XML-Dokument aufnehmen.
                </p>
                <p>Eine neue Eigenschaft und ein neues XML-Element:</p>
                <ul>
                    <li>
                        <scheduler_method class="Order" property="xml_payload"/>
                    </li>
                    <li>
                        <scheduler_element name="xml_payload"/>
                    </li>
                </ul>
            </description>
        </revision>

        <revision type="new" title="&lt;web_service job_chain=''&gt;">
            <description>
                <p>
                    Ein Web-Service kann mit einer Jobkette implementiert werden.
                </p>
                <p>Neue XML-Elemente, neue Attribute:</p>
                <ul>
                    <li>
                        <scheduler_element name="web_service" attribute="job_chain"/>
                    </li>
                    <li>
                        <scheduler_element name="web_service" attribute="timeout"/>
                    </li>
                </ul>
                <p>Neue Klassen und Methoden:</p>
                <ul>
                    <li>
                        <scheduler_method class="Order" property="web_service_operation"/>
                    </li>
                    <li>
                        <scheduler_method class="Web_service_operation"/>
                    </li>
                    <li>
                        <scheduler_method class="Web_service_request"/>
                    </li>
                    <li>
                        <scheduler_method class="Web_service_response"/>
                    </li>
                </ul>
            </description>
        </revision>
    </change>

    <change date="2006-02-21" version="2.0.147" subversion_revision="4100">
        <revision type="correction" title="Dateityp jdbc löscht temporäre Dateien unter Windows">
            <description>
                <p>
                    Beim Schreiben eines LOBs wurde die temporäre Dateien nicht gelöscht,
                    weil FileInputStream.close() nicht gerufen wurde.
                    Gilt nicht für Oracle.
                    Das ist korrigiert.
                </p>
            </description>
        </revision>
    </change>
            
    <change date="2006-02-20" version="2.0.147" subversion_revision="4099">
        <revision type="correction" title="HTTP-Server korrigiert">
        </revision>
    </change>
            
    <change date="2006-02-09" version="2.0.147" subversion_revision="4091">
        <revision type="new" title="Variable_set.names">
            <description>
                <p>
                    <scheduler_method class="Variable_set" property="names"/>
                    liefert die Variablennamen, durch Semikolon getrennt.
                </p>
            </description>
        </revision>
    </change>
            
    <change date="2006-02-02" version="2.0.146" subversion_revision="4073">
        <revision type="correction" title="factory.ini queue_dir=">
            <description>
                <p>
                    queue_dir kann wieder in der Datei factory.ini eingestellt werden. 
                    Betrifft Scheduler ab 2.0.139.3889 (2005-09-15).
                </p>
                <p>
                    Die beste Stelle für diese Einstellung bleibt in der Datei <scheduler_ini_entry file="sos.ini" section="mail" entry="queue_dir"/>.
                </p>
            </description>
        </revision>
    </change>
            
    <change date="2006-01-30" version="2.0.146" subversion_revision="4061">
        <revision type="new" title="Web-Dienste">
            <description>
                <p>Neue XML-Elemente, neue Attribute:</p>
                <ul>
                    <li><scheduler_element name="web_services"/></li>
                    <li><scheduler_element name="web_service"/></li>
                    <li><scheduler_element name="add_order" attribute="web_service"/></li>
                    <li><scheduler_element name="start_job" attribute="web_service"/></li>
                    <li><scheduler_element directory="xml/answer/" name="order" attribute="web_service"/></li>
                    <li><scheduler_element name="payload"/></li>
                    <li><scheduler_element directory="xml/answer/" name="task" attribute="web_service"/></li>
                    <li><scheduler_element name="service_request"/></li>
                    <li><scheduler_element name="content"/></li>
                    <li><scheduler_element name="job_chain" attribute="visible" value="no"/></li>
                    <li><scheduler_element name="job"       attribute="visible" value="no"/></li>
                </ul>
                <p>Neue Klassen und Methoden:</p>
                <ul>
                    <li><scheduler_method class="Web_service"/></li>
                    <li><scheduler_method class="Order" property="xml"/></li>
                    <li><scheduler_method class="Order" property="web_service"/></li>
                    <li><scheduler_method class="Task" property="web_service"/></li>
                </ul>
            </description>
        </revision>
    </change>

    <change date="2006-01-15" version="2.0.145" subversion_revision="4049">
        <revision type="new" title="Job_chain.remove()">
            <description>
                <p>
                    Neue Kommandos <scheduler_method class="Job_chain" method="remove"/> und
                    <scheduler_element name="remove_job_chain"/>.
                </p>
            </description>
        </revision>
    </change>

    <change date="2005-12-15" version="2.0.144" subversion_revision="4038">
        <revision type="correction" title="Order.setback() und Job.set_max_order_setbacks() jetzt auch in Java verfügbar">
            <description>
                <p>
                    Siehe <scheduler_method class="Order" method="setback"/> und
                    <scheduler_method class="Job" property="max_order_setbacks"/>.
                </p>
            </description>
        </revision>
    </change>

    <change date="2005-12-08" version="2.0.144" subversion_revision="4036">
        <revision type="correction" title="eMail-Einstellungen aus factory.ini [job ...] werden wieder berücksichtigt">
            <description>
                <p>
                    Wenn eine Task mit Fehler oder Warnung endet,
                    überschreibt der Scheduler die Einstellung von <code>log_mail_subject</code>.
                    Das eMail-Stylesheet kann dies ändern.
                </p>
            </description>
        </revision>
    </change>

    <change date="2005-11-11" version="2.0.144" subversion_revision="4026">
        <revision type="correction" title="Auftrag mit &lt;run_time&gt; weckt jetzt auf Auftrag wartende Task">
            <description>
                <p>
                    Bislang hat der Scheduler einen wegen <code>run_time</code> wiederholten Auftrag verschlafen,
                    wenn bereits eine Task auf den Auftrag wartete (im Zustand <code>running_waiting_for_order</code>).
                </p>
            </description>
        </revision>
    </change>

    <change date="2005-11-08" version="2.0.144" subversion_revision="4015">
        <revision type="correction" title="SQL-Tabellenamen ohne &quot;&quot;; Große order.payload möglich">
            <description>
                <p>
                    Die SQL-Anweisungen des Schedulers verwenden die Tabellennamen großgeschrieben ohne Anführungszeichen.
                    (Ausnahme: Zugriffe über den Dateityp sql).
                </p>
                <p>
                    Die <scheduler_method class="Order" property="payload"/> wird mit dem Hostware-Mechanismus als CLOB geschrieben
                    und kann damit beliebig groß sein. Das ist gut für <scheduler_method class="Variable_set"/>.
                </p>
            </description>
        </revision>

        <revision type="modification" title="HPUX: Hostjava ist im Scheduler eingebunden">
            <description>
                <p>
                    Weil es ein Problem mit gcc 3.2 beim Nachladen der libhostjava.sl gibt
                    (die statischen Variablen werden nicht initialisiert), 
                    ist Hostjava auf HP-UX fest eingebunden.
                </p>
                <p>
                    system_information() implementiert für HP-UX die Plattenplatz-Funktionen bereit.
                </p>
            </description>
        </revision>

        <revision type="modification" title="Tabelle scheduler_variables geändert">
            <description>
                <p>
                    Die Spalte "wert" ist jetzt ein Integer. Die neue Spalte Textwert ist ein Varchar(250)
                    (wird vom Scheduler zurzeit nicht verwendet).
                </p>
            </description>
        </revision>

    </change>
    
    <change date="2005-11-07" version="2.0.143" subversion_revision="4005">
        <revision type="correction" title="&lt;security ignore_unknown_hosts=&quot;yes&quot;&gt;">
            <description>
                <p>
                    <scheduler_element name="security" attribute="ignore_unknown_hosts" value="yes"/> funktioniert wieder.
                </p>
            </description>
        </revision>
    </change>
    
    <change date="2005-11-03" version="2.0.142" subversion_revision="4003">
        <revision type="new" title="&lt;job java_options=&gt;">
            <description>
                <p>
                    Siehe <scheduler_element name="job" attribute="java_options"/>.
                </p>
                <p>
                    Außerdem wirkt <scheduler_element name="config" attribute="java_options"/> jetzt auch, 
                    wenn ein Job in einem eigenen Prozess läuft.
                </p>
            </description>
        </revision>
    </change>
    
    <change date="2005-10-31" version="2.0.140" subversion_revision="3999">
        <revision type="modification" title="Job-&lt;script&gt; ist überschreibbar">
            <description>
                <p>
                    Siehe <scheduler_element name="script"/>.
                </p>
                <p>
                    Die Attribute (<code>language=</code> etc.) sind nicht änderbar.
                    Nur der Skript-Code mit <scheduler_element name="include"/> ist änderbar.
                    Die nächste Task verwendet den neuen Skript-Code.
                </p>
            </description>
        </revision>
    </change>
    
    <change date="2005-10-30" version="2.0.140" subversion_revision="3995">
        <revision type="new" title="Monitor zur Überwachung eines Jobs">
            <description>
                <p>
                    Siehe <scheduler_element name="monitor"/>.
                </p>
                <p>
                    Für Monitoren in Javascript muss die aktuelle spidermonkey.dll bzw. libspidermonkey.so eingesetzt werden.
                </p>
            </description>
        </revision>
        <revision type="new" title="Neues XML-Element &lt;job_chains&gt;">
            <description>
                <p>
                    Siehe <scheduler_element name="job_chains"/>.
                </p>
            </description>
        </revision>
        <revision type="new" title="Neues XML-Element &lt;start_when_directory_changed&gt;">
            <description>
                <p>
                    Siehe <scheduler_element name="start_when_directory_changed"/>.
                </p>
            </description>
        </revision>
        <revision type="new" title="Neues XML-Element &lt;delay_after_error&gt;">
            <description>
                <p>
                    Siehe <scheduler_element name="delay_after_error"/>.
                </p>
            </description>
        </revision>
        <revision type="new" title="Neues XML-Element &lt;delay_order_after_setback&gt;">
            <description>
                <p>
                    Siehe <scheduler_element name="delay_order_after_setback"/>.
                </p>
            </description>
        </revision>
    </change>

    <change date="2005-09-25" version="2.0.140" subversion_revision="3943">
        <revision type="modification" title="Wegen &lt;run_time&gt; wiederholter Auftrag erzeugt eigenen Historieneintrag">
            <description>
                <p>
                    Wenn ein Auftrag mit den Endzustand erreicht hat und 
                    dessen <scheduler_method class="Order" property="run_time"/>  einen weiteren Termin vorsieht,
                    dann
                </p>
                <ul>
                    <li>
                        schließt der Scheduler das Auftragsprotokoll, 
                    </li>
                    <li>
                        schreibt einen Eintrag in die Auftragshistorie,
                        siehe <scheduler_ini_entry file="factory.ini" section="spooler" entry="db_order_history_table"/>,
                    </li>
                    <li>
                    und beginnt ein neues Auftragsprotokoll.
                    </li>
                </ul>
            </description>
        </revision>
    </change>

    <change date="2005-09-24" version="2.0.140" subversion_revision="3939">
        <revision type="modification" title="Windows: Doppeltes Ctrl-C bricht alle Prozesse ab">
            <description>
                <p>
                    Das erste Ctrl-C 
                    beendet den Scheduler wie <scheduler_element name="modify_spooler" attribute="cmd" value="terminate"/>.
                </p>
                <p>
                    Das zweite Ctrl-C führt dann zum Abbruch aller Prozesse.
                </p>
                <p>
                    Erst das dritte lässt das Betriebssystem den Scheduler abbrechen.
                </p>
            </description>
        </revision>

        <revision type="new" title="Terminate mit Frist">
            <description>
                <p>
                    Der Scheduler kann jetzt mit Frist beendet werden.
                    Wenn innerhalb der Frist die Tasks nicht enden, bricht der Scheduler die Prozesse der Tasks ab,
                    und wartet dann längstens weitere 30s auf die Tasks, bevor er sich beendet.
                </p>
                <p>
                    Siehe <scheduler_element name="modify_spooler" attribute="cmd" value="terminate"/> und
                    <scheduler_method class="Spooler" method="terminate"/>.
                </p>
            </description>
        </revision>
    </change>

    <change date="2005-09-21" version="2.0.139" subversion_revision="3925">
        <revision type="modification" title="Fehlerhaftes &lt;include&gt; im &lt;description&gt; eines Jobs führt zur Warnung im Jobprotokoll">
            <description>
                <p>
                    (Bisher gab's einen Fehler nur im Hauptprotokoll.)
                </p>
                <p>
                    Siehe <scheduler_element name="description"/>.
                </p>
            </description>
        </revision>
    </change>

    <change date="2005-09-15" version="2.0.139" subversion_revision="3889">
        <revision type="modification" title="Neue Behandlung der Voreinstellungen für den eMail-Versand"/>
    </change>

    <change date="2005-09-07" version="2.0.138" subversion_revision="3866">
        <revision type="correction" title="spooler_log.debug1() bis spooler_log.debug9() im Scheduler-Skript werden nicht mehr unterdrückt"/>
        <revision type="modification" title="Datenbanktabellen werden mit varchar statt char angelegt"/>
    </change>

    <change date="2005-09-06" version="2.0.138" subversion_revision="3851">
        <revision type="new" title="Option -pid-file wird bei Installation als Windows-Dienst übernommen">
            <description>
                <p>
                    Siehe <scheduler_option name="pid-file"/>
                </p>
            </description>
        </revision>

        <revision type="new" title="XSLT-eMail erhält &lt;order&gt;-Element">
            <description>
                <p>
                    Das Element <scheduler_element name="order" directory="xml/answer/"/> wird
                    bei einem Abbruch der Task
                    im Element <scheduler_element name="task" directory="xml/answer/"/> geliefert.
                </p>
            </description>
        </revision>
    </change>

    <!--change date="2005-08-28" version="2.0.137" subversion_revision="3851">
        <revision type="correction" title="Scheduler beendet sich wieder, wenn eine Jobkette gefüllt ist (Folge der Implementierung von remove_job)"/>
    </change-->

    <change date="2005-08-24" version="2.0.137" subversion_revision="3844">
        <revision type="correction" title="-sos.ini= akzeptiert Leerzeichen im Dateinamen"/>
    </change>

    <change date="2005-08-21" version="2.0.137" subversion_revision="3839">
        <revision type="new" title="Neue Methode Job.remove(), neues XML-Kommando &lt;modify_job cmd=&quot;remove&quot;&gt;">
            <description>
                <p>
                    Siehe <scheduler_method class="Job" method="remove"/>
                    und <scheduler_element name="modify_job" attribute="cmd" value="remove"/>.
                </p>
            </description>
        </revision>

        <revision type="correction" title="&lt;remove_order&gt; wirkt sofort auf Datenbank"/>
        <revision type="correction" title="Fehler-eMails jetzt mit richtigem Nachrichtentext"/>
    </change>

    <change date="2005-08-12" version="2.0.136" subversion_revision="3836">
        <revision type="new" title="Neue Methoden Task.stdout_path und Task.stderr_path">
            <description>
                <p>
                    Siehe <scheduler_method class="Task" property="stdout_path"/>
                    und <scheduler_method class="Task" property="stderr_path"/>.
                </p>
            </description>
        </revision>

        <revision type="correction" title="&lt;remove_order&gt; wirkt sofort auf Datenbank"/>
        <revision type="correction" title="Fehler-eMails jetzt mit richtigem Nachrichtentext"/>
    </change>

    <change date="2005-08-12" version="2.0.136" subversion_revision="3834">
        <revision type="correction" title="Fehler bei SQL-Insert für neue Task führt nicht mehr zur eMail-Flut"/>
    </change>

    <change date="2005-08-12" version="2.0.134" subversion_revision="3832">
        <revision type="modification" title="Änderung der &lt;run_time&gt; eines Auftrags wirkt nur am Beginn der Jobkette">
            <description>
                <p>
                    Eine Änderung der &lt;run_time&gt; eines Auftrags wirkt nur,
                    wenn er am Anfang der Jobkette steht und noch nicht ausgeführt wird.
                    Sonst wird die Wirkung verzögert, bis der Auftrag einen Endzustand erreicht hat.
                </p>
            </description>
        </revision>
    </change>

    <change date="2005-08-10" version="2.0.135" subversion_revision="3824">
        <revision type="new" title="Kommando &lt;modify_order&gt; kann &lt;run_time&gt; ändern">
            <description>
                <p>
                    In <scheduler_element name="modify_order"/> kann jetzt
                    <scheduler_element name="run_time"/> gesetzt werden.
                </p>
            </description>
        </revision>

        <revision type="new" title="Methode Job_chain.add_or_replace_order() neu">
            <description>
                <p>
                    <scheduler_method class="Job_chain" method="add_or_replace_order" java_signature="sos.spooler.Order" />
                    wirkt wie
                    <scheduler_method class="Job_chain" method="add_order" java_signature="sos.spooler.Order" />,
                    wenn die Jobkette keinen Auftrag mit gleicher Kennung hat.
                </p>
                <p>
                    Hat die Jobkette bereits einen Auftrag mit gleicher Kennung, dann wird dieser ersetzt.
                    Genauer: er wird aus der Jobkette entfernt
                    (wie mit <scheduler_method class="Order" method="remove_from_job_chain"/>),
                    und der neue Auftrag wird hinzugefügt.
                </p>
                <p>
                    Falls der ersetzte Auftrag gerade von einer Task ausgeführt wird,
                    dann wartet der Scheduler die Ausführung ab, bevor der neue Auftrag ausgeführt werden kann.
                </p>
                <p>
                    Der ersetzte Auftrag erscheint in der XML-Antwort als
                    <scheduler_element name="order" directory="xml/answer/" attribute="replaced" value="yes"/>.
                    Dies nur innerhalb von
                    <scheduler_element name="task" directory="xml/answer/"/>,
                    (nicht von <scheduler_element name="order_queue" directory="xml/answer/"/>),
                    denn der Auftrag ist nicht mehr in der Auftragswarteschlange.
                </p>
                <p>
                    Der neue, ersetzende Auftrag erscheint in der XML-Antwort als
                    <scheduler_element name="order" directory="xml/answer/" attribute="replacement" value="yes"/>.
                </p>
                <p>
                    Siehe auch <scheduler_element name="add_order" attribute="replace" value="yes"/>.
                </p>
            </description>
        </revision>

        <revision type="modification" title="Methode Order.remove_from_job_chain() geändert">
            <description>
                <p>
                    (<scheduler_method class="Order" method="remove_from_job_chain"/> wirkt wie
                    <scheduler_element name="remove_order" />.)
                </p>
                <p>
                    Wenn der Auftrag gerade von einer Task ausgeführt wird,
                    liefert die Eigenschaft <scheduler_method class="Order" property="job_chain" />
                    weiterhin die Jobkette, aus der der Auftrag gerade entfernt wird.
                    Erst wenn die Ausführung beendet ist, liefert die Eigenschaft <code>null</code>
                    (außer der Auftrag ist wieder in eine Jobkette eingetragen worden).
                    Damit bleibt die Eigenschaft <code>job_chain</code> während der Ausführung durch die Task stabil.
                </p>
                <p>
                    Der entfernte, aber noch ausgeführte Auftrag erscheint in der XML-Antwort als
                    <scheduler_element name="order" directory="xml/answer/" attribute="removed" value="yes"/>.
                    Dies nur innerhalb von
                    <scheduler_element name="task" directory="xml/answer/"/>,
                    (nicht von <scheduler_element name="order_queue" directory="xml/answer/"/>),
                    denn der Auftrag ist nicht mehr in der Auftragswarteschlange.
                </p>
            </description>
        </revision>

        <revision type="correction" title="Java-Methode sos.spooler.id() liefert auch Integer als String">
            <description>
                <p>
                    Statt einem Cast <code>(String)</code> wird jetzt <code>.toString()</code> gerufen,
                    so dass auch eine Auftragskennung,
                    die als Integer-Variant (o.dgl.) gespeichert ist,
                    in Java als String geliefert wird.
                    (Bisher gab es eine ClassCastException.)
                </p>
            </description>
        </revision>

        <revision type="correction" title="let_run_terminate_and_restart beendet Tasks im Zustand running_waiting_for_order">
            <description>
                <p>
                    Siehe <scheduler_element name="modify_spooler" attribute="cmd" value="let_run_terminate_and_restart"/>.
                </p>
            </description>
        </revision>

    </change>

    <change date="2005-08-04" version="2.0.134" subversion_revision="3818">
        <revision type="correction" title="Klasse sos.spooler.Mail unter Unix/Java funktionsfähig">
            <description>
                <p>
                    Unter Unix in Java war die Klasse sos.spooler.Mail nicht benutzbar (Fehlercode COM-80020009  DISP_E_EXCEPTION).
                </p>
            </description>
        </revision>
    </change>

    <change date="2005-08-03" version="2.0.134" subversion_revision="3817">
        <revision type="correction" title="Order &lt;period single_start&gt; korrigiert">
            <description>
                <p>
                    Der nächste Single_start bei einem Auftrag mit
                    <scheduler_element name="period" attrbute="single_start"/>
                    wird jetzt korrekt ausgeführt.
                </p>
            </description>
        </revision>
    </change>

    <change date="2005-08-01" version="2.0.134" subversion_revision="3814">
        <revision type="new" title="Subprocess.termination_signal">
            <description>
                <p>
                    <scheduler_method class="Subprocess" property="termination_signal" />
                    liefert unter Unix 0 oder die Nummer des Signals, mit dem der Subprozess endete.
                </p>
                <p>
                    Unter Windows liefert die Methode 0.
                </p>
            </description>
        </revision>
    </change>

    <change date="2005-07-30" version="2.0.134" subversion_revision="3812">
        <revision type="new" title="delay_after_error erzeugt neue Task">
            <description>
                <p>
                    Eine Task, für die nach einem Fehler
                    <scheduler_method class="Job" property="delay_after_error" java_signature="int, double" access="write"/>
                    wirksam wird,
                    fügt der Scheduler jetzt (mit neuer Kennung) erneut in die Task-Warteschlange ein.
                    Dabei werden die Task-Parameter übernommen.
                </p>
                <p>
                    Das gilt nicht für Auftragsjobs.
                    Für die wird wie bisher keine neue Task gestartet,
                    denn der Start wird durch den evtl. anstehenden Auftrag angestossen.
                </p>
            </description>
        </revision>

        <revision type="new" title="Neues Attribut delayed_after_error_task im Antwort-XML-Element &lt;task&gt;">
            <description>
                <p>
                    Siehe <scheduler_element directory="xml/answer/" name="task" attribute="delayed_after_error_task"/>.
                </p>
            </description>
        </revision>

        <revision type="new" title="Neue Attribute delay_after_error= und in_period= im Antwort-XML-Element &lt;job&gt;">
            <description>
                <p>
                    Siehe <scheduler_element directory="xml/answer/" name="job" attribute="delay_after_error"/>
                    <br/>
                    und <scheduler_element directory="xml/answer/" name="job" attribute="in_period"/>.
                </p>
            </description>
        </revision>

    </change>

    <change date="2005-07-04" version="2.0.133" subversion_revision="3786">
        <revision type="new" title="XSLT-Stylesheets für eMails">
            <description>
                <p>
                    <scheduler_method class="Mail" property="xslt_stylesheet_path" java_signature="java.lang.String" access="write"/>
                    setzt das XSLT-Stylesheet für eMails.
                </p>
            </description>
        </revision>

        <revision type="new" title="Neue Klasse Xslt_stylesheet">
            <description>
                <p>
                    <scheduler_method class="Spooler" method="create_xslt_stylesheet" />
                    liefert ein <scheduler_method class="Xslt_stylesheet" />.
                </p>
            </description>
        </revision>
    </change>

    <change date="2005-06-25" version="2.0.132" subversion_revision="3743">
        <revision type="new" title="&lt;order_queue&gt; liefert Attribut next_start_time"/>
    </change>

    <change date="2005-06-24" version="2.0.130" subversion_revision="3742">
        <revision type="correction" title="Fehlendes &lt;run_time&gt; wird wieder wie leeres &lt;run_time/&gt; interpretiert"/>
    </change>

    <change date="2005-06-08" version="2.0.129" subversion_revision="3696">
        <revision type="modification" title="Auftragsjob stoppt bei return false in spooler_init() oder spooler_open()">
            <description>
                <p>
                    Ein Auftragsjob, der
                    <code>false</code> in
                    <scheduler_method class="Job_impl" method="spooler_init"/>
                    oder
                    <scheduler_method class="Job_impl" method="spooler_open"/>
                    liefert,
                    wird mit Fehlermeldung gestoppt.
                </p>
                <p>
                    Das Stoppen kann mit
                    <scheduler_method class="Job" property="delay_after_error" java_signature="int, double" access="write"/>
                    verhindert werden.
                </p>
                <p>
                    Der Auftrag bleibt in der Auftragswarteschlange des Jobs
                    und wird beim nächsten erfolgreichen Start des Jobs verarbeitet.
                </p>
            </description>
        </revision>
    </change>

</changes>
