<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet href="../scheduler.xsl" type="text/xsl"?>

<!--$Id$-->

<xml_element name     = "job"
             title    = "Job"
             category = "Konfiguration"
             base_dir = "../"
             parent_page = "../konfiguration.xml"
             author   = "$Author$"
             date     = "$Date$">

    <xml_parent_elements>
        <xml_parent_element name="jobs">
        </xml_parent_element>
    </xml_parent_elements>

    <xml_attributes>
        <xml_attribute name="spooler_id" same_as_element="config"/>
<!--
            <description>
                <p>
                    Kennung des <span class="sos_name">Schedulers</span>,
                    für den der Job bestimmt ist. Der Job wird vom <span class="sos_name">Scheduler</span>
                    nur berücksichtigt, wenn dieses Attribut nicht leer ist und mit der Option
                    <scheduler_option name="spooler-id"/> vom <span class="sos_name">Scheduler</span>-Start übereinstimmt.
                </p>
            </description>
        </xml_attribute>
-->

        <xml_attribute name="name" type="jobname">
            <description>
                <p>
                    Jeder Job hat einen eigenen Namen.
                </p>
                <p>
                    Wenn ein Job mit demselben Namen in einer Basiskonfiguration bereit definiert worden ist,
                    können hier die Einstellungen des Jobs geändert oder ergänzt werden.
                </p>
            </description>
        </xml_attribute>

        <xml_attribute name="title" type="text">
            <description>
                Eine einzeilige Beschreibung des Jobs.
            </description>
        </xml_attribute>

        <xml_attribute name="order" type="yes_no">
            <description>
                <p>
                    Bei <code>order="yes"</code> ist der Job auftragsgesteuert. Der Scheduler startet diesen Job nur, wenn ein Auftrag vorliegt.
                </p>
            </description>
        </xml_attribute>

        <xml_attribute name="process_class" type="prozessklasse">
            <description>
                Gibt den Namen der Prozessklasse an, in der Tasks dieses Jobs laufen sollen.
                Die Prozessklassen werden mit <scheduler_element name="process_classes"/> definiert.
            </description>
        </xml_attribute>

        <xml_attribute name="tasks" type="zahl" initial="1">
            <description>
                Von einem Job können mehrere Tasks gleichzeitig laufen. Dieses Attribut begrenzt deren Anzahl.
            </description>
        </xml_attribute>

        <xml_attribute name="timeout" type="dauer">
            <description>
                <p>
                    Befristet eine Task-Opertion (spooler_open, spooler_process etc.).
                    Nach Ablauf der Frist bricht der Scheduler die Task ab.
                </p>
                <p>
                    <i>dauer</i> kann als Sekunden oder im Format HH:MM oder HH:MM:SS angegeben werden.
                </p>
            </description>
        </xml_attribute>

        <xml_attribute name="idle_timeout" type="dauer">
            <description>
                <p>
                    Begrenzt den Leerlauf eines auftragsgesteuerten Jobs (<code>order="yes"</code>).
                    Wenn eine Task auf den nächsten Auftrag wartet, und in der Frist kein Auftrag
                    eintrifft, beendet der Scheduler sie.
                </p>
                <p>
                    <i>dauer</i> kann als Sekunden oder im Format HH:MM oder HH:MM:SS angegeben werden.
                </p>
            </description>
        </xml_attribute>


        <xml_attribute name="priority" type="process_priority">
            <description>
                <p>
                    Unter Unix sind die Werte -20 bis 20 zulässig.
                </p>
                <p>
                    Eingestellt können die Werte 
                    <code>idle</code>,
                    <code>below_normal</code>,
                    <code>normal</code>,
                    <code>above_normal</code> und
                    <code>high</code>
                    oder die numerischen Werte des Betriebsystems.
                </p>
                <p>
                    Wenn die Priorität nicht gesetzt werden kann, führt das nicht zu einem Fehler.
                </p>
                <p>
                    Ein Prozess mit hoher Priorität kann Ihren Rechner blockieren.
                </p>
                <p>
                    Siehe
                    <scheduler_method class="Task" property="priority_class"/>.
                </p>
            </description>
        </xml_attribute>


        <xml_attribute name="temporary" type="yes_no">
            <description>
                <p>
                    Bei <code>temporary="yes"</code> ist der Job temporär.
                    Nur für <scheduler_element name="add_jobs"/>.
                    Nach der Ausführung wird der Job gelöscht und ist dann unbekannt.
                </p>
            </description>
        </xml_attribute>


        <xml_attribute name="java_options" type="string">
            <description>
                <p>
                    Wirkt nur, wenn der Job als eigener Prozess ausgeführt wird 
                    (s. <scheduler_element name="process_classes"/>) und der Job oder der Monitor in Java implementiert ist.
                    Die Optionen werden zusammen mit den Optionen aus 
                    <scheduler_element name="config" attribute="java_options"/> Java übergeben.
                    Wie gleichnamige Optionen interpretiert werden, hängt von Java ab.
                </p>
            </description>
        </xml_attribute>


        <xml_attribute name="visible" type="yes|no" initial="yes">
            <description>
                <p>
                    <code>visible="no"</code> lässt den Job im Ergebnis von 
                    <scheduler_element name="show_jobs"/> und
                    <scheduler_element name="show_state"/> 
                    unsichtbar.
                </p>
                <p>
                    Der Scheduler setzt den Job sichtbar, sobald eine Task eingereiht wird.
                </p>
            </description>
        </xml_attribute>
    </xml_attributes>

    <xml_child_elements>
        <xml_child_element name="description"/>
        <xml_child_element name="params"/>
        <xml_child_element name="script"/>
        <xml_child_element name="process"/>
        <xml_child_element name="start_when_directory_changed" multiple="yes"/>
        <xml_child_element name="delay_after_error"            multiple="yes"/>
        <xml_child_element name="delay_order_after_setback"    multiple="yes"/>
        <xml_child_element name="run_time"/>
    </xml_child_elements>


    <behavior_with_xml_element element="base" complete_attribute="name"/>

    <description>
        <p>
            Definiert einen Job mit Programmcode, Laufzeit usw.
        </p>
    </description>


</xml_element>
