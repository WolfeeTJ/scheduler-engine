<?xml version="1.0"?>
<spooler
    xmlns:xsi                     = "http://www.w3.org/2001/XMLSchema-instance" 
    xsi:noNamespaceSchemaLocation = "s:/prod/scheduler/scheduler.xsd"
>
    <config 
        tcp_port="4444"
        main_scheduler="lillerud.zschimmer:6310"
    >

        <security>
            <allowed_host host="0.0.0.0" level="all"/>
        </security>

        <process_classes/>

        <jobs>
            <job name="javascript">
                <environment>
                    <variable name="ENV_A" value="env_a"/>
                    <variable name="ENV_B" value="env_b"/>
                </environment>
                
                <params>
                    <param name="params_env_a" value="$ENV_A"/>
                    <param name="params_a" value="*params_a*"/>
                    <param name="params_b" value="*params_b*"/>
                </params>
                
                <script language="JavaScript">
                    <![CDATA[

var subprocess = spooler_task.create_subprocess();
//spooler_log.info( "subprocess.env.names=" + subprocess.env.names );
var names = subprocess.env.names.split( ";" );
for( var i in names )  spooler_log.info( names[i] + "=" + subprocess.env.value( names[i] ) );

                    ]]>
                </script>
                <run_time/>
            </job>

            <job name="shell">
                <environment>
                    <variable name="ENV_A" value="env_a"/>
                    <variable name="ENV_B" value="env_b"/>
                </environment>

                <params>
                    <param name="params_env_a" value="$ENV_A"/>
                    <param name="params_a" value="*params_a*"/>
                    <param name="params_b" value="*params_b*"/>
                </params>

                <script language="shell">set</script>
                <run_time/>
            </job>

            <job name="order_shell" order="yes">
                <environment>
                    <variable name="ENV_A" value="env_a"/>
                    <variable name="ENV_B" value="env_b"/>
                </environment>

                <params>
                    <param name="params_env_a" value="$ENV_A"/>
                    <param name="params_a" value="*params_a*"/>
                    <param name="params_b" value="*params_b*"/>
                </params>

                <script language="shell">set</script>
                <run_time/>
            </job>

            <job name="java">
                <script java_class="spooler_job.My_job">
                    <![CDATA[
package spooler_job;
import sos.spooler.*;

public class My_job  extends sos.spooler.Job_impl
{   
    public boolean spooler_process()  throws Exception
    {
        return false;
    }
}
                ]]>
                </script>
                <run_time once="no"/>
            </job>
        </jobs>

        
        <job_chains>
            <job_chain name="environment">
                <job_chain_node state="1" job="order_shell"/>
            </job_chain>
        </job_chains>
        

        <commands>
            <start_job job="javascript">
                <environment>
                    <variable name="ENV_B" value="*ENV_B der Task*"/>
                </environment>
                <params>
                    <param name="params_b" value="*params_b der task*"/>
                </params>
            </start_job>

            <start_job job="shell">
                <environment>
                    <variable name="ENV_B" value="*ENV_B der Task*"/>
                </environment>
                <params>
                    <param name="params_b" value="*params_b der task*"/>
                </params>
            </start_job>

            <add_order job_chain="environment">
                <params>
                    <param name="params_b" value="*params_b des Auftrags*"/>
                </params>
            </add_order>
        </commands>
    </config>
</spooler>
